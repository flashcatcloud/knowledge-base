---
title: "ServiceNow Sync"
description: "Sync incidents with ServiceNow Incidents through ServiceNow sync webhook."
date: "2025-05-19T10:00:00+08:00"
url: "https://docs.flashcat.cloud/en/flashduty/service-now-sync"
---

Through ServiceNow sync webhook, Flashduty incidents are associated and synchronized with ServiceNow Incidents to achieve integration between Flashduty and ServiceNow.

## In ServiceNow

### Create User

1. Log in to the ServiceNow instance console, select `ALL`, enter `USERS` and select `Organization`-`Users`.
2. Click `New` to create a new user.
3. In the edit page, enter `flashduty` in the `User ID` field.
4. Keep `Password needs reset`, `Web service access only`, and `Internal Integration User` unchecked.
5. Submit and save.

<img alt="drawing" width="600" src="https://download.flashcat.cloud/flashduty/doc/snow/snow-1.png" />

### Configure User
The user used to access ServiceNow needs to have administrator roles.
1. On the user list page, find the newly created `flashduty` user and go to the configuration page.
2. In the edit page, click `Set Password` to set a password.
3. Click `Roles` to add **admin and itil** roles.
4. Click `Update` to update the configuration.

<img alt="drawing" width="600" src="https://download.flashcat.cloud/flashduty/doc/snow/snow-2.png" />



## In Flashduty

### Configure Integration

Enter the username/password and instance name configured above into the integration information on the left and click Next to configure.

- **Integration Name:** Define a name for the current integration.
- **Management Team:** When a management team is selected, only team members and tenant administrators can edit this integration.
- **Channel:** Select the channel where this integration takes effect.
- **Sync Direction:** 
    - To_ServiceNow: Sync Flashduty incidents to ServiceNow.
    - From_ServiceNow: Sync ServiceNow Incidents to Flashduty.
    - Two-way: Bidirectional sync between Flashduty and ServiceNow.
- **Trigger Mode**:
    - Auto Trigger: Requires configuration of corresponding conditions, Flashduty will automatically sync incidents that meet the conditions to ServiceNow.
    - Manual Trigger: Requires manual triggering of ServiceNow sync in the More Actions section of the incident details page (the integration configuration name is the trigger name).
- **Severity Mapping:** ServiceNow's Priority is determined by the combined values of Impact and Urgency, so you can refer to ServiceNow's `Priority Lookup Rules` for configuration. Additionally, note that only when ServiceNow Incident's Urgency changes will it trigger updates to Flashduty incident severity.
- **Custom Field Mapping:** You can choose to sync certain labels or all labels of incidents as well as custom field content to ServiceNow fields (only text-type fields are supported).

## In ServiceNow

When sync direction is set to From_ServiceNow or Two-way, additional configuration is required in ServiceNow to sync ServiceNow Incidents to Flashduty. When syncing to Flashduty, there are two methods available, choose based on your actual needs.

### Manual Sync

This method relies on ServiceNow's UI Action and Script Include configuration. The effect achieved by following the steps below: When creating or updating an Incident, you can see a button to send sync requests in the function area. Triggering this button will sync the current Incident content to Flashduty. Note that if the request fails when triggered, please retry (retry interval should be greater than 10 seconds).

#### Configure UI Action

1. Log in to the ServiceNow instance console, select `ALL`, enter `UI Actions` and select `System Definition`-`UI Actions`.
2. Click `New` to create a new Action.
3. Enter **Send To Flashduty** in `Name`, select **Incident** in `Table`.
4. Keep `Form button`, `Active`, `Show insert`, `Show update`, `Client`, `List v2/3 Compatible` checked.
5. Enter **onClick();** in `Onclick`.
6. Enter the following in `Script`:

    ```
    function onClick() {
        g_form.save(); 

        var ga = new GlideAjax('IncidentWebhookHelperAjax');
        ga.addParam('sysparm_name', 'sendWebhook');
        ga.addParam('sysparm_sys_id', g_form.getUniqueValue());
        
        ga.getXMLAnswer(function(response) {
            alert('Webhook Triggered: ' + response);
        });
    }

    ```

7. Submit and save.

#### Configure Script Include

1. Log in to the ServiceNow instance console, select `ALL`, enter `Script Includes` and select `System Definition`-`Script Includes`.
2. Click `New` to create a new Script Include.
3. Enter **IncidentWebhookHelper** in `Name`, select **All application scopes** in `Accessible from`.
4. Keep `Client callable` and `Active` checked.
5. Enter the following content in `Script`, where you need to add the integration push URL in **request.setEndpoint**:

<div class="hide">

Note: The body configures default receiving fields. If you have custom fields that need to be synced to Flashduty, you need to manually add content to the body. For example, if you want to add a field named: test_001 (this field name can be obtained when adding custom fields in the integration configuration, do not use the field name displayed in the ServiceNow Incident form), then you need to add to the body: test_001: current.getDisplayValue("test_001").

</div>
    ```
    var IncidentWebhookHelper = Class.create();
    IncidentWebhookHelper.prototype = {
    initialize: function() {},

    sendIncidentWebhook: function(current) {
        function getLastComment(sysId) {
            var journalGR = new GlideRecord('sys_journal_field');
            journalGR.addQuery('element_id', sysId);
            journalGR.addQuery('element', 'comments');
            journalGR.orderByDesc('sys_created_on');
            journalGR.setLimit(1);
            journalGR.query();
            if (journalGR.next()) {
                return journalGR.getValue('value');
            }
            return '';
        }

        var body = {
            action_type: current.isNewRecord() ? 'insert' : 'update',
            number: current.getValue("number"),
            sys_id: current.getUniqueValue(),
            short_description: current.getValue("short_description"),
            description: current.getValue("description"),
            state: current.getDisplayValue("state"),
            impact: current.getDisplayValue("impact"),
            urgency: current.getDisplayValue("urgency"),
            comments: getLastComment(current.getUniqueValue())
        };

        try {
            var request = new sn_ws.RESTMessageV2();
            request.setHttpMethod("POST");
            request.setEndpoint("PUSH URL");
            request.setRequestHeader("Content-Type", "application/json");
            request.setRequestBody(JSON.stringify(body));
            request.executeAsync();
            } catch (ex) {
            gs.error("Webhook Call failed: " + ex.message);
        }
    },

    type: 'IncidentWebhookHelper'
    };

    ```

6. Submit and save.
7. Return to the Script Includes list and continue creating.
8. Click `New` to create a new Script Include.
9. Enter **IncidentWebhookHelperAjax** in `Name`, select **All application scopes** in `Accessible from`.
10. Keep `Client callable` and `Active` checked.
11. Enter the following content in `Script`:

    ```
    var IncidentWebhookHelperAjax = Class.create();
    IncidentWebhookHelperAjax.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {
    sendWebhook: function() {
        var sysId = this.getParameter('sysparm_sys_id');
        var gr = new GlideRecord('incident');
        if (gr.get(sysId)) {
            var helper = new IncidentWebhookHelper(); 
            helper.sendIncidentWebhook(gr);
                return 'Success';
        }
        return 'Request failed';
    }
    });
    ```
  
12. Submit and save.

### Auto Sync
This method relies on ServiceNow's Business Rules configuration. Using this method, you can automatically sync Incidents to Flashduty when there are new or update events.

#### Configure Business Rules

1. Log in to the ServiceNow instance console, select `ALL`, enter `Business Rules` and select `System Definition`-`Business Rules`.
2. Click `New` to create a new Business Rule.
3. Enter **Send To Flashduty** in `Name`, select **Incident** in `Table`.
4. Keep `Advanced` and `Active` checked.
5. In the `When to run` section, select **async** in `When`, keep `Insert` and `Upsert` checked, configure others as needed.
6. In the `Advanced` section, enter the following content in `Script`, where you need to add the integration push URL in **endpoint**:

<div class="hide">

Note: The body configures default receiving fields. If you have custom fields that need to be synced to Flashduty, you need to manually add content to the body. For example, if you want to add a field named: test_001 (this field name can be obtained when adding custom fields in the integration configuration, do not use the field name displayed in the ServiceNow Incident form), then you need to add to the body: test_001: current.getDisplayValue("test_001").

</div>

   ```
    (function executeRule(current, previous) {
        function getLastComment(recordSysId) {
            var journalGR = new GlideRecord('sys_journal_field');
            journalGR.addQuery('element_id', recordSysId);
            journalGR.addQuery('element', 'comments');
            journalGR.orderByDesc('sys_created_on');
            journalGR.setLimit(1); 
            journalGR.query();
            if (journalGR.next()) {
                var comment = journalGR.getValue('value');
                return comment;
            }
    
            return '';
        }

        var operation = current.operation() || 'unknown';
        var isPreviousNull = previous === null;
        var createdOn = current.getValue('sys_created_on');
        var updatedOn = current.getValue('sys_updated_on');
        var isNewRecord = createdOn === updatedOn; 

        var action = 'update'; 
        if (isPreviousNull && isNewRecord) {
            action = 'insert'; 
        }

        var body = {
            action_type: action,
            number: current.getValue("number"),
            sys_id: current.getUniqueValue(),
            short_description: current.getValue("short_description"),
            description: current.getValue("description"),
            state: current.getDisplayValue("state"),
            impact: current.getDisplayValue("impact"),
            urgency: current.getDisplayValue("urgency"),
            comments: getLastComment(current.getUniqueValue())
        };

        try {
            var endpoint = ''; 
            var request = new sn_ws.RESTMessageV2();
            request.setHttpMethod("POST");
            request.setEndpoint(endpoint);
            request.setRequestHeader("Content-Type", "application/json");
            request.setRequestBody(JSON.stringify(body));
            request.executeAsync(); 
        } catch (ex) {
            gs.error("Error sending webhook: " + ex.message);
        }

})(current, previous);

    ```
7. Submit and save.

## Sync Information

### Form Fields
| ServiceNow |  Flashduty | Notes |
| ---------- | -------- | ---- |
| Short_description    | Title |  |
| Description    | Description  |  |
| Additional comments     | Comments     |  |
| State      | Progress     |  |
| Urgency      | Severity     |  |
| Others      | Custom Fields     |  |

### Status Mapping

| ServiceNow |  Flashduty | Notes |
| ---------- | -------- | ---- |
| New   | Trigger |  |
| In Progress    | Processing  |  |
| On Hold     | Snoozed     | Default snooze 2 hours  |
| Resolved     | CLosed     |  |
| Closed     | CLosed      |  |
| Canceled    | CLosed      |  |


### Priority Mapping
Only when ServiceNow's Urgency value changes will it affect Flashduty's Severity

| ServiceNow |  Flashduty | Notes |
| ---------- | -------- | ---- |
| Low   | Info |  |
| Medium    | Warning  |  |
| High     | Critical     |  |
