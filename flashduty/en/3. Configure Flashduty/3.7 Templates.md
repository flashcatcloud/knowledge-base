---
title: "Configure Notification Templates"
description: "Customize notification content through template configuration"
date: "2024-05-10T10:00:00+08:00"
url: "https://docs.flashcat.cloud/en/flashduty/template-settings"
---

<!-- >
## Video Tutorial
---
<Video src="https://download.flashcat.cloud/flashduty/video/template.mp4"></Video>
-->

## When Are Templates Used?
---
The system uses templates to render [Incident](#Incident) when assigning incidents, which may occur in the following scenarios:

1. Manually create and assign an incident
2. When an alert event is reported, the system automatically generates an incident and assigns it according to the matched escalation rule
3. After an incident is created, manually change the assignment (reassign)
4. System automatically escalates according to escalation rule settings
5. When reopening a closed incident, reassign according to previous settings

We use `Golang template syntax` [template/html](https://pkg.go.dev/html/template@go1.18.1) to parse data, enabling you to accomplish any complex rendering requirements.

- For documentation, please refer to [here](https://www.topgoer.com/%E5%B8%B8%E7%94%A8%E6%A0%87%E5%87%86%E5%BA%93/template.html#%E6%A8%A1%E6%9D%BF%E8%AF%AD%E6%B3%95), supporting logical conditions, loops, pipelines, and common functions;
- We've incorporated the open-source library [sprig](https://github.com/flashcatcloud/sprig/tree/flashcat), which includes hundreds of common functions that you can directly call in templates;
- If you wish to introduce more functions, feel free to submit a merge request

## What Variables Can I Reference?
---
**Variable Reference Examples**:

```go
// Reference title
{{.Title}}

// Reference creator name
{{.Creator.PersonName}}

// Reference resource label value
{{.Labels.resource}}

// Reference label value with "." in name
{{index .Labels "A.B"}}
```

**Complete Variable List** (Direct Reference):
<span id="Incident"></span>
Field|Type|Required|Description
:-:|:-:|:-:|:---
ID | string | Yes | Incident ID
`Title` | string | Yes | Incident title
`Description` | string | Yes | Incident description, can be empty
DetailUrl | string | Yes | Incident detail page URL
Num | string | Yes | Short incident identifier, for easy visual recognition, may be duplicate
`IncidentSeverity` | string | Yes | Severity level, enum values: Critical, Warning, Info
IncidentStatus | string | Yes | Incident status, enum values: Critical, Warning, Info, Ok
`Progress` | string | Yes | Processing progress, enum values: Triggered, Processing, Closed
`StartTime` | int64 | Yes | Trigger time, Unix timestamp in seconds
LastTime | int64 | No | Latest event time, latest incorporated event time in associated alerts, Unix timestamp in seconds, default 0
EndTime | int64 | No | Recovery time, when all associated alerts recover, the incident will automatically recover and close. Unix timestamp in seconds, default 0
SnoozedBefore | int64 | No | Snooze end time, Unix timestamp in seconds, default 0
AckTime | int64 | No | First acknowledgment time, Unix timestamp in seconds, default 0
CloseTime | int64 | No | Close time, end_time is incident recovery time, close_time is processing progress close time. Incident automatically closes upon recovery, manual closure doesn't affect recovery. Unix timestamp in seconds, default 0
Creator | [Person](#Person) | No | Creator information, not present when automatically generated by system
Closer | [Person](#Person) | No | Closer information, not present when incident recovers automatically
AssignedTo | [Assignment](Assignment) | No | Assignment configuration
Responders | [][Responder](#Responder) | No | Responder list, initialized based on assignment configuration, also includes records if non-assigned personnel acknowledge the incident
ChannelID | int64 | No | Channel ID, value is 0 when manually creating global incident
ChannelName | string | No | Channel name
GroupMethod | string | No | Grouping method, enum values: n: no grouping, p: rule-based grouping, i: intelligent grouping
`Labels` | map[string]string | No | Label key-value pairs, both Key and Value are strings. No information when manually created, contains first alert's label information when automatically created
AlertCnt | int64 | Yes | Number of associated alerts
Alerts | [][Alert](#Alert) | No | Associated alert details, no information when manually created
FireType | string | No | Notification type, enum values: fire: notify, refire: loop notification
IsFlapping | bool | No | Whether in flapping state, i.e., frequent occurrence and recovery, related to convergence configuration
Impact | string | No | Incident impact, filled after incident closure
RootCause | string | No | Root cause, filled after incident closure
Resolution | string | No | Resolution, filled after incident closure

<span id="Person"></span>
**Person** (Indirect Reference):
Field|Type|Required|Description
:-:|:-:|:-:|:---
person_id | int64 | Yes | Person ID
person_name | string | Yes | Person name
email | string | Yes | Email address

<span id="Assignment"></span>
**Assignment** (Indirect Reference):
Field|Type|Required|Description
:-:|:-:|:-:|:---
PersonIDs | []string| No | Person ID list, exists only when assigning by person
EscalateRuleID | string | No | Escalation rule ID, exists only when assigning by rule
EscalateRuleName | string | No | Escalation rule name
LayerIdx | string | No | Assignment level, corresponds to escalation rule level index, starts from 0
Type | string | Yes | Assignment type, enum values: assign: assign, reassign: reassign, escalate: escalation assign, reopen: reopen assign

<span id="Responder"></span>
**Responder** (Indirect Reference):
Field|Type|Required|Description
:-:|:-:|:-:|:---
PersonID | int64 | Yes | Person ID
PersonName | string | Yes | Person name
Email | string | Yes | Email address
AssignedAt | int64 | Yes | Assignment time, Unix timestamp in seconds, default 0
AcknowledgedAt | int64 | No | Acknowledgment time, Unix timestamp in seconds, default 0

<span id="Alert"></span>
**Alert** (Indirect Reference):
Field|Type|Required|Description
:-:|:-:|:-:|:---
Title | string | Yes | Alert title
Description | string | Yes | Alert description, can be empty
AlertSeverity | string | Yes | Severity level, enum values: Critical, Warning, Info
AlertStatus | string | Yes | Alert status, enum values: Critical, Warning, Info, Ok
Progress | string | Yes | Processing progress, enum values: Triggered, Processing, Closed
StartTime | int64 | Yes | Trigger time, Unix timestamp in seconds
EndTime | int64 | No | Recovery time, Unix timestamp in seconds, default 0
CloseTime | int64 | No | Close time, EndTime is alert recovery time, CloseTime is processing progress close time. Alert automatically closes upon recovery, manual closure doesn't affect alert recovery. Unix timestamp in seconds, default 0
`Labels` | map[string]string | No | Label key-value pairs, both Key and Value are strings

## Common Questions
---
1. **How do I know what label information is available in `Labels`?**

   - Manually created incidents have no labels
   - Automatically created incidents have labels, matching the first incorporated alert's labels. Go to the `Incidents` page, find an incident and view its details to see all label information

2. **Why is the `default template` used when I configured custom template rendering?**

   - When creating a custom template, the system uses mock data to render the template to check for syntax errors
   - Mock data has limited coverage and may not match some logic branches in your template during actual operation
   - If rendering fails, the system will use the default template as a fallback to ensure message delivery
   - When unsure if a referenced variable exists, it's recommended to use logical conditions to avoid rendering errors, e.g., for the `resource` label:

   ```go
   // Wrong approach: directly read label
   {{.Labels.resource}}

   // Recommended: check first, then read label
   {{if .Labels.resource}}{{.Labels.resource}}{{end}}
   ```

3. **Why are characters like ">" `escaped` in incident titles?**

   ```go
   // Use toHtml function
   {{toHtml .Title}}

   // Use first non-empty value for rendering, avoiding complex if logic
   {{toHtml .Title .TitleEnglish}}
   ```

4. **Time variables are timestamps, how do I `convert time formats`?**

   ```go
   // date function converts timestamp to readable format
   // "2006-01-02 15:04:05" is a common format, search online for more formats
   {{date "2006-01-02 15:04:05" .StartTime}}

   // ago function converts time difference to readable format
   {{ago .StartTime}}
   ```

5. **How to reference external variables inside a for loop?**
   ```go
   // Add "$" before external variables
   {{range .Responders}}
   	{{if eq $.Progress "Triggered"}}
   		[Pending]{{.Email}}
   	{{end}}
   {{end}}
   ```
6. **How do I extract field values with "." in names, like "obj.instance" in labels?**

   ```go
   // Use index function
   {{index .Labels "obj.instance"}}
   ```

7. **How do I extract and deduplicate label information from incident-associated alerts?**

   ```go
   // Use alertLabels function to get deduplicated array
   {{alertLabels . "resource"}}

   // Use joinAlertLabels function to get deduplicated array, then join with "sep"
   {{joinAlertLabels . "resource" "sep"}}
   ```

8. **How do I iterate and print labels?**

   ```go
   // Complete iteration
   {{range $k, $v := .Labels}}
     {{$k}} : {{toHtml $v}}
   {{end}}

   // Exclude single label
   {{range $k, $v := .Labels}}
     {{if ne $k "resource"}}
       {{$k}} : {{toHtml $v}}
     {{end}}
   {{end}}

   // Exclude multiple labels
   {{range $k, $v := .Labels}}
     {{if not (in $k "resource" "body_text")}}
       {{$k}} : {{toHtml $v}}
     {{end}}
   {{end}}
  
9. **How do I extract information from JSON fields?**
     
   - jsonGet function helps extract values from JSON format data using path
   - Target data for jsonGet function must be valid JSON
   - Basic usage: {{jsonGet .Labels.xxx "yyy"}}, where xxx must be valid JSON and yyy is a valid extraction path
   - For JSON path syntax, refer to [gjson.dev](https://gjson.dev/), where you can input target data and extraction path for real-time preview
   
    ```go
    // Extract detail_url field from rule_note label
    {{jsonGet .Labels.rule_note "detail_url"}}

    // Extract name field from first element in JSON array
    {{jsonGet .Labels.slice "0.name"}}
    
    // Iterate through JSON array elements, match instanceId field of object with userId==7777
    {{jsonGet .Labels.rule_note "#(userId==7777)#.instanceId" }}

    ```
10. **Â¶Ç‰Ωï‰ΩøÁî®ÈÄªËæë‰∏é„ÄÅÊàñÁ≠âÊù°‰ª∂ËøõË°åÂÜÖÂÆπÊòæÁ§∫Âà§Êñ≠Ôºü**

    ```
    # Supported functions
    - Use `and` function for logical AND judgment
    - Use `or` function for logical OR judgment
    - Use `not` function for logical NOT judgment
    - Use `eq` function for logical equal judgment
    - Use `ne` function for logical not equal judgment
    - Use `gt` function for logical greater than judgment
    - Use `ge` function for logical greater than or equal judgment
    - Use `lt` function for logical less than judgment
    - Use `le` function for logical less than or equal judgment

    # Example usage
    # Use and function for logical AND judgment
    
    {{if and (eq .Labels.resource "cpu") (eq .Labels.metric "cpu_usage")}}
      {{.Labels.resource}} CPU usage exceeds 80%
    {{end}}

    # Use or function for logical OR judgment
    {{if or (eq .Labels.resource "cpu") (eq .Labels.metric "cpu_usage")}}
      {{.Labels.resource}} CPU usage exceeds 80%
    {{end}}  

    # Use not function for logical NOT judgment
    {{if not (eq .Labels.metric "cpu_usage")}}
      {{.Labels.metric}} is not CPU usage
    {{end}}
  
    ```

11. **How do I find more functions and their usage examples?**
   - Function list: https://github.com/flashcatcloud/sprig/blob/master/functions.go#L97
   - Usage examples: Check corresponding _test.go files, e.g., date function test cases at https://github.com/flashcatcloud/sprig/blob/master/date_test.go

Below are specific instructions for each notification channel.

<div class="feishu_app hide">

## Feishu/Lark App
---
You need to configure `Integration Center-Instant Message-Feishu` integration first to send message cards. If custom content is not set, the system default template will be used, rendering all label information:

```go
{{if .Description}}**description** :{{toHtml .Labels.body_text .Description}}{{end}}
{{if .Labels.resource}}**resource** : {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text")}}**{{$k}}** : {{toHtml $v}}{{end}}{{end}}
```

As shown below:

<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/feishu_app_render.png" alt="drawing" style="display: block; margin: 0 auto;" width="500"/>

If you want to display only key label information, you can refer to the code segment below:

- We've listed some common labels, you can add or remove as needed
- In Feishu app, the system will automatically remove empty rendered lines (due to non-existent labels), so you can configure freely

```go
{{if (index .Labels "resource")}}resourceÔºö{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{if (index .Labels "check")}}checkÔºö{{toHtml (index .Labels "check")}}{{end}}
{{if (index .Labels "metric")}}metricÔºö{{index .Labels "metric"}}{{end}}
{{if (index .Labels "prom_ql")}}prom_qlÔºö{{toHtml (index .Labels "prom_ql")}}{{end}}
{{if (index .Labels "host_ql")}}host_qlÔºö{{toHtml (index .Labels "host_ql")}}{{end}}
{{if (index .Labels "trigger_value")}}trigger_valueÔºö{{index .Labels "trigger_value"}}{{end}}
{{if (index .Labels "region")}}regionÔºö{{index .Labels "region"}}{{end}}
{{if (index .Labels "cluster")}}clusterÔºö{{index .Labels "cluster"}}{{end}}
{{if (index .Labels "business")}}businessÔºö{{index .Labels "business"}}{{end}}
{{if (index .Labels "service")}}serviceÔºö{{index .Labels "service"}}{{end}}
{{if (index .Labels "env")}}envÔºö{{index .Labels "env"}}{{end}}
{{if (index .Labels "type")}}typeÔºö{{index .Labels "type"}}{{end}}
{{if (index .Labels "topic")}}topicÔºö{{index .Labels "topic"}}{{end}}
{{if (index .Labels "cpu")}}cpuÔºö{{index .Labels "cpu"}}{{end}}
{{if (index .Labels "device")}}deviceÔºö{{index .Labels "device"}}{{end}}
{{if (index .Labels "path")}}pathÔºö{{index .Labels "path"}}{{end}}
{{if (index .Labels "fstype")}}fstypeÔºö{{index .Labels "fstype"}}{{end}}
{{if (index .Labels "name")}}nameÔºö{{index .Labels "name"}}{{end}}
{{if (index .Labels "mode")}}modeÔºö{{index .Labels "mode"}}{{end}}
{{if (index .Labels "runbook_url")}}runbook_urlÔºö{{toHtml (index .Labels "runbook_url")}}{{end}}
```
</div>

<div class="dingtalk_app hide">

## Dingtalk App
---
You need to configure `Integration Center-Instant Message-Dingtalk` integration first to send message cards. If custom content is not set, the system default template will be used, rendering all label information:

```go
{{if .Description}}**description** :{{toHtml .Labels.body_text .Description}}{{end}}
{{if .Labels.resource}}**resource** : {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text")}}**{{$k}}** : {{toHtml $v}}{{end}}{{end}}
```

As shown below:

<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/dingtalk_app_render.png" alt="drawing" style="display: block; margin: 0 auto;" width="500"/>

If you want to display only key label information, you can refer to the code segment below:

- We've listed some common labels, you can add or remove as needed
- In Dingtalk app, the system will automatically remove empty rendered lines (due to non-existent labels), so you can configure freely

```go
{{if (index .Labels "resource")}}**resource**Ôºö{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{if (index .Labels "metric")}}**metric**Ôºö{{index .Labels "metric"}}{{end}}
{{if (index .Labels "prom_ql")}}**prom_ql**Ôºö{{toHtml (index .Labels "prom_ql")}}{{end}}
{{if (index .Labels "trigger_value")}}**trigger_value**Ôºö{{index .Labels "trigger_value"}}{{end}}
{{if (index .Labels "host_ql")}}**host_ql**Ôºö{{toHtml (index .Labels "host_ql")}}{{end}}
{{if (index .Labels "region")}}**region**Ôºö{{index .Labels "region"}}{{end}}
{{if (index .Labels "cluster")}}**cluster**Ôºö{{index .Labels "cluster"}}{{end}}
{{if (index .Labels "business")}}**business**Ôºö{{index .Labels "business"}}{{end}}
{{if (index .Labels "service")}}**service**Ôºö{{index .Labels "service"}}{{end}}
{{if (index .Labels "env")}}**env**Ôºö{{index .Labels "env"}}{{end}}
{{if (index .Labels "type")}}**type**Ôºö{{index .Labels "type"}}{{end}}
{{if (index .Labels "topic")}}**topic**Ôºö{{index .Labels "topic"}}{{end}}
{{if (index .Labels "cpu")}}**cpu**Ôºö{{index .Labels "cpu"}}{{end}}
{{if (index .Labels "device")}}**device**Ôºö{{index .Labels "device"}}{{end}}
{{if (index .Labels "path")}}**path**Ôºö{{index .Labels "path"}}{{end}}
{{if (index .Labels "fstype")}}**fstype**Ôºö{{index .Labels "fstype"}}{{end}}
{{if (index .Labels "name")}}**name**Ôºö{{index .Labels "name"}}{{end}}
{{if (index .Labels "mode")}}**mode**Ôºö{{index .Labels "mode"}}{{end}}
{{if (index .Labels "runbook_url")}}**runbook_url**Ôºö{{index .Labels "runbook_url"}}{{end}}
```
</div>

<div class="wecom_app hide">

## WeCom App
---

You need to configure `Integration Center-Instant Message-WeCom` integration first to send message cards. If custom content is not set, the system default template will be used, rendering only common label information:

- We've listed some common labels, you can add or remove as needed
- In WeCom app, the system will automatically remove empty rendered lines (due to non-existent labels), so you can configure freely

```go
{{if (index .Labels "resource")}}resourceÔºö{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{if (index .Labels "metric")}}metricÔºö{{index .Labels "metric"}}{{end}}
{{if (index .Labels "prom_ql")}}prom_qlÔºö{{toHtml (index .Labels "prom_ql")}}{{end}}
{{if (index .Labels "trigger_value")}}trigger_valueÔºö{{index .Labels "trigger_value"}}{{end}}
{{if (index .Labels "host_ql")}}host_qlÔºö{{toHtml (index .Labels "host_ql")}}{{end}}
{{if (index .Labels "region")}}regionÔºö{{index .Labels "region"}}{{end}}
{{if (index .Labels "cluster")}}clusterÔºö{{index .Labels "cluster"}}{{end}}
{{if (index .Labels "business")}}businessÔºö{{index .Labels "business"}}{{end}}
{{if (index .Labels "service")}}serviceÔºö{{index .Labels "service"}}{{end}}
{{if (index .Labels "env")}}envÔºö{{index .Labels "env"}}{{end}}
{{if (index .Labels "type")}}typeÔºö{{index .Labels "type"}}{{end}}
{{if (index .Labels "topic")}}topicÔºö{{index .Labels "topic"}}{{end}}
{{if (index .Labels "cpu")}}cpuÔºö{{index .Labels "cpu"}}{{end}}
{{if (index .Labels "device")}}deviceÔºö{{index .Labels "device"}}{{end}}
{{if (index .Labels "path")}}pathÔºö{{index .Labels "path"}}{{end}}
{{if (index .Labels "fstype")}}fstypeÔºö{{index .Labels "fstype"}}{{end}}
{{if (index .Labels "name")}}nameÔºö{{index .Labels "name"}}{{end}}
{{if (index .Labels "mode")}}modeÔºö{{index .Labels "mode"}}{{end}}
{{if (index .Labels "runbook_url")}}runbook_urlÔºö{{toHtml (index .Labels "runbook_url")}}{{end}}
```

As shown below:

<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/wecom_app_render.png" alt="drawing" style="display: block; margin: 0 auto;" width="500"/>

**Note: WeCom limits card length. In the template rendering area, you can render no more than 8 lines of content. Content beyond 8 lines will be hidden**

</div>

<div class="slack_app hide">

## Slack App
---
You need to configure `Integration Center-Instant Message-Slack` integration first to send message cards. If custom content is not set, the system default template will be used, rendering only common label information:

```go
{{if .Description}}*description* :{{toHtml .Labels.body_text .Description}}{{end}}
{{if .Labels.resource}}*resource* : {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text")}}*{{$k}}* : {{toHtml $v}}{{end}}{{end}}
```

As shown below:

<img src="https://download.flashcat.cloud/flashduty/integration/slack/slack_app_message.png" alt="drawing" style="display: block; margin: 0 auto;" width="600"/>

If you want to display only key label information, you can refer to the code segment below:

- We've listed some common labels, you can add or remove as needed
- Messages can be around 15000 characters long, content beyond this will be truncated
- In Slack app, the system will automatically remove empty rendered lines (due to non-existent labels), so you can configure freely

```go
{{if (index .Labels "resource")}}*resource*Ôºö{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{if (index .Labels "metric")}}*metric*Ôºö{{index .Labels "metric"}}{{end}}
{{if (index .Labels "prom_ql")}}*prom_ql*Ôºö{{toHtml (index .Labels "prom_ql")}}{{end}}
{{if (index .Labels "trigger_value")}}*trigger_value*Ôºö{{index .Labels "trigger_value"}}{{end}}
{{if (index .Labels "host_ql")}}*host_ql*Ôºö{{index .Labels "host_ql"}}{{end}}
{{if (index .Labels "region")}}*region*Ôºö{{index .Labels "region"}}{{end}}
{{if (index .Labels "cluster")}}*cluster*Ôºö{{index .Labels "cluster"}}{{end}}
{{if (index .Labels "business")}}*business*Ôºö{{index .Labels "business"}}{{end}}
{{if (index .Labels "service")}}*service*Ôºö{{index .Labels "service"}}{{end}}
{{if (index .Labels "env")}}*env*Ôºö{{index .Labels "env"}}{{end}}
{{if (index .Labels "type")}}*type*Ôºö{{index .Labels "type"}}{{end}}
{{if (index .Labels "topic")}}*topic*Ôºö{{index .Labels "topic"}}{{end}}
{{if (index .Labels "cpu")}}*cpu*Ôºö{{index .Labels "cpu"}}{{end}}
{{if (index .Labels "device")}}*device*Ôºö{{index .Labels "device"}}{{end}}
{{if (index .Labels "path")}}*path*Ôºö{{index .Labels "path"}}{{end}}
{{if (index .Labels "fstype")}}*fstype*Ôºö{{index .Labels "fstype"}}{{end}}
{{if (index .Labels "name")}}*name*Ôºö{{index .Labels "name"}}{{end}}
{{if (index .Labels "mode")}}*mode*Ôºö{{index .Labels "mode"}}{{end}}
{{if (index .Labels "runbook_url")}}*runbook_url*Ôºö{{index .Labels "runbook_url"}}{{end}}
```
</div>

<div class="teams_app hide">

## Microsoft Teams App
---
You need to configure `Integration Center-Instant Message-Microsoft Teams` integration first to send message cards. If custom content is not set, the system default template will be used, rendering only common label information:

```
{{if .Description}}**description** :{{toHtml .Labels.body_text .Description}}{{end}}
{{if .Labels.resource}}**resource** : {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{range $k, $v := .Labels}}
{{if not (in $k "resource" "body_text" "body_text_with_table")}}**{{$k}}** : {{toHtml $v}}{{end}}{{end}}
```

As shown below:

<img src="https://download.flashcat.cloud/flashduty/integration/microsoft-teams/teams_app_message.png" alt="drawing" style="display: block; margin: 0 auto;" width="300"/>

If you want to display only key label information, you can refer to the code segment below:

- We've listed some common labels, you can add or remove as needed
- Messages can be around 28KB in size, content beyond this will result in an error
- In Microsoft Teams app, the system will automatically remove empty rendered lines (due to non-existent labels), so you can configure freely

```
{{if (index .Labels "resource")}}**resource**Ôºö{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}
{{if (index .Labels "metric")}}**metric**Ôºö{{index .Labels "metric"}}{{end}}
{{if (index .Labels "prom_ql")}}**prom_ql**Ôºö{{toHtml (index .Labels "prom_ql")}}{{end}}
{{if (index .Labels "trigger_value")}}**trigger_value**Ôºö{{index .Labels "trigger_value"}}{{end}}
{{if (index .Labels "host_ql")}}**host_ql**Ôºö{{index .Labels "host_ql"}}{{end}}
{{if (index .Labels "region")}}**region**Ôºö{{index .Labels "region"}}{{end}}
{{if (index .Labels "cluster")}}**cluster**Ôºö{{index .Labels "cluster"}}{{end}}
{{if (index .Labels "business")}}**business**Ôºö{{index .Labels "business"}}{{end}}
{{if (index .Labels "service")}}**service**Ôºö{{index .Labels "service"}}{{end}}
{{if (index .Labels "env")}}**env**Ôºö{{index .Labels "env"}}{{end}}
{{if (index .Labels "type")}}**type**Ôºö{{index .Labels "type"}}{{end}}
{{if (index .Labels "topic")}}**topic**Ôºö{{index .Labels "topic"}}{{end}}
{{if (index .Labels "cpu")}}**cpu**Ôºö{{index .Labels "cpu"}}{{end}}
{{if (index .Labels "device")}}**device**Ôºö{{index .Labels "device"}}{{end}}
{{if (index .Labels "path")}}**path**Ôºö{{index .Labels "path"}}{{end}}
{{if (index .Labels "fstype")}}**fstype**Ôºö{{index .Labels "fstype"}}{{end}}
{{if (index .Labels "name")}}**name**Ôºö{{index .Labels "name"}}{{end}}
{{if (index .Labels "mode")}}**mode**Ôºö{{index .Labels "mode"}}{{end}}
{{if (index .Labels "runbook_url")}}**runbook_url**Ôºö{{index .Labels "runbook_url"}}{{end}}
```
</div>

<div class="sms hide">

## Feishu/Lark Bot
---
Feishu/Lark bot supports message cards, rich text, and plain text formats. The default template is in message card format.

- The msg_type field is required for message cards and rich text, otherwise it will be sent as plain text format
- The maximum message length is `4000 bytes, content exceeding this limit will be truncated`
- If no custom content is set, the system default template will be used to display key information:

1. Message Card
msg_type is required, value should be interactive
```
{
  "msg_type": "interactive",
  "card": {
    "config": {
      "wide_screen_mode": true,
      "enable_forward": true
    },
    "header": {
      "template": "{{if eq .IncidentSeverity "Critical"}}red{{else if eq .IncidentSeverity "Warning"}}orange{{else}}yellow{{end}}",
      "title": {
        "content": "{{fireReason .}}INC #{{.Num}} {{toHtml .Title}}",
        "tag": "plain_text"
      }
    },
    "elements": [{
      "tag": "div",
      "fields": [{
          "text": {
            "tag": "lark_md",
            "content": "**üè¢ Channel:**{{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}"
          }
        },
        {
          "text": {
            "tag": "lark_md",
            "content": "**{{if eq .IncidentSeverity "Critical"}}üî¥{{else if eq .IncidentSeverity "Warning"}}‚ö†Ô∏è{{else}}‚ÑπÔ∏è{{end}} Severity:**{{.IncidentSeverity}}"
          }
        },
        {
          "text": {
            "tag": "lark_md",
            "content": "**‚è∞ Triggered at:**{{date "2006-01-02 15:04:05" .StartTime}}{{if gt .AlertCnt 1}}"
          }
        },
        {
          "text": {
            "tag": "lark_md",
            "content": "**üîî Grouped alerts:**{{.AlertCnt}} {{end}}{{if .Labels.resource}}"
          }
        },
        {
          "tag": "div",
          "text": {
            "tag": "lark_md",
            "content": "**üìå Alert targets:**{{toHtml (joinAlertLabels . "resource" ",")}} {{end}}{{if .Description}}"
          }
        },
        {
          "tag": "div",
          "text": {
            "tag": "lark_md",
            "content": "**üîç Description:**{{.Description}}{{end}}{{if gt (len .Responders) 0}}"
          }
        },
        {
          "tag": "div",
          "text": {
            "tag": "lark_md",
            "content": "**üë®‚Äçüíª Responders:**{{range .Responders}}@{{.PersonName}} {{end}}{{end}}"
          }
        }
      ]
    },
    {
      "tag": "hr"
    },
    {
      "tag": "action",
      "actions": [{
          "tag": "button",
          "text": {
            "tag": "plain_text",
            "content": "Details"
          },
          "type": "primary",
          "url": "{{.DetailUrl}}"
        },
        {
          "tag": "button",
          "text": {
            "tag": "plain_text",
            "content": "Acknowledge"
          },
          "type": "primary",
          "url": "{{.DetailUrl}}?ack=1"
        }
      ]
    }]
  }
}
```

2. Rich Text
msg_type is required, value should be post
```
{
    "msg_type": "post",
    "post": {
        "zh_cn": {
            "title": "{{if eq .IncidentSeverity "Critical"}}üî¥{{else if eq .IncidentSeverity "Warning"}}‚ö†Ô∏è{{else}}‚ÑπÔ∏è{{end}} {{fireReason .}}INC #{{.Num}} {{toHtml .Title}}",
            "content": [
                [{
                    "tag": "text",
                    "text": "üè¢ "
                }, {
                    "tag": "text",
                    "text": "ChannelÔºö",
                    "text_type": "bold"
                }, {
                    "tag": "text",
                    "text": "{{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}\n"
                }],
                [{
                    "tag": "text",
                    "text": "{{if eq .IncidentSeverity "Critical"}}üî¥{{else if eq .IncidentSeverity "Warning"}}‚ö†Ô∏è{{else}}‚ÑπÔ∏è{{end}} "
                }, {
                    "tag": "text",
                    "text": "SeverityÔºö",
                    "text_type": "bold"
                }, {
                    "tag": "text",
                    "text": "{{.IncidentSeverity}}\n",
                    "text_type": "{{if eq .IncidentSeverity "Critical"}}bold{{end}}"
                }],
                [{
                    "tag": "text",
                    "text": "‚è∞ "
                }, {
                    "tag": "text",
                    "text": "Triggered atÔºö",
                    "text_type": "bold"
                }, {
                    "tag": "text",
                    "text": "{{date "2006-01-02 15:04:05" .StartTime}}\n"
                }],
                {{if gt .AlertCnt 1}}[{
                    "tag": "text",
                    "text": "üîî "
                }, {
                    "tag": "text",
                    "text": "Grouped alertsÔºö",
                    "text_type": "bold"
                }, {
                    "tag": "text",
                    "text": "{{.AlertCnt}}\n"
                }],{{end}}
                {{if .Labels.resource}}[{
                    "tag": "text",
                    "text": "üìã "
                }, {
                    "tag": "text",
                    "text": "Alert targetsÔºö",
                    "text_type": "bold"
                }, {
                    "tag": "text",
                    "text": "{{toHtml (joinAlertLabels . "resource" ", ")}}\n"
                }],{{end}}
                {{if .Description}}[{
                    "tag": "text",
                    "text": "üìù "
                }, {
                    "tag": "text",
                    "text": "DescriptionÔºö",
                    "text_type": "bold"
                }, {
                    "tag": "text",
                    "text": "{{toHtml .Description}}\n"
                }],{{end}}
                {{if gt (len .Responders) 0}}[{
                    "tag": "text",
                    "text": "üë®‚Äçüíª "
                }, {
                    "tag": "text",
                    "text": "RespondersÔºö",
                    "text_type": "bold"
                }, {
                    "tag": "text",
                    "text": "{{range .Responders}}@{{.PersonName}} {{end}}\n"
                }],{{end}}
                [{
                    "tag": "a",
                    "href": "{{.DetailUrl}}",
                    "text": "Details"
                },{
                    "tag": "text",
                    "text": "  "
                },{
                    "tag": "a",
                    "href": "{{.DetailUrl}}?ack=1",
                    "text": "Acknowledge"
                }]
            ]
        }
    }
}
```

3. Plain Text
```
{{fireReason .}}INC #{{.Num}} {{toHtml .Title}}
-----
ChannelÔºö{{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}
SeverityÔºö{{.IncidentSeverity}}
Triggered atÔºö{{date "2006-01-02 15:04:05" .StartTime}}
DurationÔºö{{ago .StartTime}}{{if gt .AlertCnt 1}}
Grouped alertsÔºö{{.AlertCnt}}{{end}}{{if .Labels.resource}}
Alert targetsÔºö{{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}{{if .Description}}
DescriptionÔºö{{toHtml .Description}}{{end}}{{if gt (len .Responders) 0}}
RespondersÔºö{{range .Responders}}@{{.PersonName}} {{end}}{{end}}
<br>DetailsÔºö{{.DetailUrl}}
```
</div>

<div class="dingtalk hide">

## Dingtalk Bot
---
Dingtalk bot only supports sending Markdown messages ([syntax restrictions](https://open.dingtalk.com/document/robots/custom-robot-access#title-7ur-3ok-s1a)).

- The maximum message length is `4000 bytes, content exceeding this limit will be truncated`
- If the text contains `<br>`, when rendering, the system will `first remove empty lines, then replace <br> with line breaks`
- If no custom content is set, the system default template will be used to display key information:

```
{{fireReason .}}INC [#{{.Num}}]({{.DetailUrl}}) {{toHtml .Title}}

---
- Channel: {{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}
- Severity: {{$s := colorSeverity .IncidentSeverity}}{{toHtml $s}}
- Triggered at: {{date "2006-01-02 15:04:05" .StartTime}}
- Duration: {{ago .StartTime}}{{if gt .AlertCnt 1}}
- Grouped alerts: {{.AlertCnt}}{{end}}{{if .Labels.resource}}
- Alert targets: {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}{{if .Description}}
- Description: {{toHtml .Description}}{{end}}{{if gt (len .Responders) 0}}
- Responders: {{range .Responders}}@{{.PersonName}} {{end}}{{end}}
---
<br>[Details]({{.DetailUrl}})|[Acknowledge]({{.DetailUrl}}?ack=1)
```
</div>

<div class="wecom hide">

## WeCom Bot
---
WeCom bot only supports sending Markdown messages ([syntax restrictions](https://developer.work.weixin.qq.com/document/path/91770#markdown%E7%B1%BB%E5%9E%8B)).

- The maximum message length is `4000 bytes, content exceeding this limit will be truncated`
- If the text contains `<br>`, when rendering, the system will `first remove empty lines, then replace <br> with line breaks`
- If no custom content is set, the system default template will be used to display key information:

```
{{fireReason .}}**INC [#{{.Num}}]({{.DetailUrl}}) {{toHtml .Title}}**
> Channel: <font color="warning">{{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}</font>
> Severity: <font color="warning">{{.IncidentSeverity}}</font>
> Triggered at: {{date "2006-01-02 15:04:05" .StartTime}}
> Duration: {{ago .StartTime}}{{if gt .AlertCnt 1}}
> Grouped alerts: {{.AlertCnt}}{{end}}{{if .Labels.resource}}
> Alert targets: {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}{{if .Description}}
> Description: {{toHtml .Description}}{{end}}{{if gt (len .Responders) 0}}
> Responders: {{range .Responders}}@{{.PersonName}} {{end}}{{end}}
<br>[Details]({{.DetailUrl}})|[Acknowledge]({{.DetailUrl}}?ack=1)
```
</div>

<div class="telegram hide">

## Telegram Bot
---

- Configure a Telegram service address accessible in mainland China
- The maximum message length is `4096 characters, content exceeding this limit will not be sent`
- If the text contains `<br>`, when rendering, the system will `first remove empty lines, then replace <br> with line breaks`
- If no custom content is set, the system default template will be used to display key information:

```
{{fireReason .}}INC [#{{.Num}}]({{.DetailUrl}}) {{toHtml .Title}}
-----
Channel: {{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}
Severity: {{.IncidentSeverity}}
Triggered at: {{date "2006-01-02 15:04:05" .StartTime}}
Duration: {{ago .StartTime}}{{if gt .AlertCnt 1}}
Grouped alerts: {{.AlertCnt}}{{end}}{{if .Labels.resource}}
Alert targets: {{toHtml (joinAlertLabels . "resource" ", ")}}({{.Labels.resource}}){{end}}{{if .Description}}
Description: {{toHtml .Description}}{{end}}{{if gt (len .Responders) 0}}
Responders: {{range .Responders}}@{{.PersonName}} {{end}}{{end}}

<br>[Details]({{.DetailUrl}})|[Acknowledge]({{.DetailUrl}}?ack=1)
```
</div>

<div class="slack hide">

## Slack Bot
---
- Messages can be `approximately 15000 characters long, content exceeding this limit will be truncated`
- If the text contains `<br>`, when rendering, the system will `first remove empty lines, then replace <br> with line breaks`
- If no custom content is set, the system default template will be used to display key information:

```
{{fireReason .}}INC <{{.DetailUrl}}|#{{.Num}}> {{toHtml .Title}}
-----
Channel: {{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}
Severity: {{.IncidentSeverity}}
Triggered at: {{date "2006-01-02 15:04:05" .StartTime}}
Duration: {{ago .StartTime}}{{if gt .AlertCnt 1}}
Grouped alerts: {{.AlertCnt}}{{end}}{{if .Labels.resource}}
Alert targets: {{toHtml (joinAlertLabels . "resource" ", ")}}{{end}}{{if .Description}}
Description: {{toHtml .Description}}{{end}}{{if gt (len .Responders) 0}}
Responders: {{range .Responders}}@{{.PersonName}} {{end}}{{end}}
-----
<br><{{.DetailUrl}}|Details>|<{{.DetailUrl}}?ack=1|Acknowledge>
```
</div>

<div class="zoom hide">

## Zoom Bot
---
- Messages can be `approximately 4000 characters long, content exceeding this limit will be truncated`
- If the text contains `<br>`, when rendering, the system will `first remove empty lines, then replace <br> with line breaks`
- Message format `follows Zoom message format`. The current bot application doesn't support Markdown. For other formats, please refer to the official documentation: https://developers.zoom.us/docs/team-chat-apps/customizing-messages/
- If no custom content is set, the system default template will be used to display key information:

```json
{"head": {
    "text": "{{fireReason .}}INC [#{{.Num}}] {{toHtml .Title}}",
    "style": {
      "bold": true,
      "italic": false,
      "color": "{{$s := serverityToColor .IncidentSeverity}}{{toHtml $s}}"
    }
  },
  "body": [
    {
      "type": "message",
      "text": "Channel: {{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "Severity: {{.IncidentSeverity}}",
      "style": {
        "bold": false,
        "italic": false,
        "color": "{{$s := serverityToColor .IncidentSeverity}}{{toHtml $s}}"
      }
    },
    {
      "type": "message",
      "text": "Duration: {{ago .StartTime}}{{if gt .AlertCnt 1}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "Grouped alerts: {{.AlertCnt}}{{end}}{{if .Labels.resource}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
        "type": "message",
        "text": "Alert targets: {{.Labels.resource}}{{end}}{{if .Description}}",
        "style": {
          "bold": false,
          "italic": false
        }
      },
    {
      "type": "message",
      "text": "Description: {{toHtml .Description}}{{end}}{{if gt (len .Responders) 0}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "Responders: {{range .Responders}}@{{.PersonName}}{{end}}{{end}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
        "type": "message",
        "text": "View Details",
        "link": "{{.DetailUrl}}{{if .IsFlapping}}"
    },
    {
      "type": "message",
      "text": "Note: The current incident status is changing frequently. Notifications will be suppressed for {{.Flapping.MuteMinutes}} minutes. Please optimize your alert policy.{{end}}{{if .IsInStorm}}",
      "style": {
        "bold": true,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "Note: The current incident has grouped {{.AlertCnt}} alerts, triggering an alert storm. Please handle with urgency!{{end}}",
      "style": {
        "bold": true,
        "italic": false
      }
    }
  ]
}
```
</div>

<div class="sms hide">

## SMS
---
If no custom content is set, the system default template will be used for notifications:

```go
You have a pending incident: {{toHtml .Title}}, Channel: {{.ChannelName}}, Severity: {{.IncidentSeverity}}{{if gt .AlertCnt 1}}, Grouped {{.AlertCnt}} alerts{{end}}
```
</div>

<div class="email hide">

## Email
---
If no custom content is set, the system default template will be used for notifications:

```html
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>{{.Title}}</title>
<html lang="en">

  <head data-id="__react-email-head">
	<style>
	  .bg-Critical { background-color: #C80000; }
	  .bg-Warning { background-color: #FA7D00; }
	  .bg-Info { background-color: #FABE00; }
	  .bg-Ok { background-color: rgb(132 204 22); }
	  .text-Critical { color: #C80000; }
	  .text-Warning { color: #FA7D00; }
	  .text-Info { color: #FABE00; }
	  .text-Ok { color: rgb(132 204 22); }
	  .text-title {font-weight:500;width:6rem;flex-shrink:0}
	  .text-content {color:rgb(55,65,81)}
	</style>
  </head>

  <body data-id="__react-email-body" style="background-color:rgb(255,255,255);border-radius:0.25rem;margin-top:2.5rem;margin-bottom:2.5rem;margin-left:auto;margin-right:auto;padding:1rem;min-width:400px;max-width:660px;font-family:ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji">
	<div style="width:100%;height:0.375rem;margin-bottom:2rem" class="bg-{{.IncidentSeverity}}"></div>
	<div style="display:flex;align-items:center;margin-bottom:1.5rem">
	  <div style="display:flex;align-items:flex-end;gap:1rem"><img witdh="120" data-id="react-email-img" src="https://console.flashcat.cloud/image/saas-logo.png" height="40" style="display:block;outline:none;border:none;text-decoration:none" /><span style="font-size:1.25rem;line-height:1.75rem;font-weight:600">You have a pending incident</span></div>
	</div>
	<div style="background-color:rgb(243,244,246);padding:2rem;margin-top:1rem;border-radius:0.5rem">
	  <div style="display:flex;flex-direction:column;gap:0.75rem">
		<div style="display:flex">
		  <div class="text-title">Title</div>
		  <div class="text-content">{{.Title}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">Severity</div>
		  <div class="text-{{.IncidentSeverity}}">{{.IncidentSeverity}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">Channel</div>
		  <div class="text-content">{{if .ChannelName}}{{.ChannelName}}{{else}}None{{end}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">Triggered at</div>
		  <div class="text-content">{{date "2006-01-02 15:04:05" .StartTime}}</div>
		</div>
		{{if .CreatorID}}
		<div style="display:flex">
		  <div class="text-title">Creator</div>
		  <div class="text-content">{{.Creator.PersonName}}</div>
		</div>
		{{end}}
		{{if gt (len .Responders) 0}}
		<div style="display:flex">
		  <div class="text-title">Responders</div>
		  <div class="text-content">{{range .Responders}}@{{.PersonName}} {{end}}</div>
		</div>
		{{end}}
		<div style="display:flex">
		  <div class="text-title">Progress</div>
		  <div class="text-content">{{.Progress}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">Description</div>
		  <div style="color:rgb(55,65,81);margin-top:0.125rem">
			<div data-id="react-email-markdown">{{toHtml .Description}}</div>
		  </div>
		</div>
		{{if .Labels.resource}}
		<div style="display:flex;margin-bottom:0.5rem;">
		  <div style="color:#000;font-weight:500;width:6rem;margin-right:1rem;">Alert targets</div>
		  <div style="color:rgb(55,65,81);margin-top:0.125rem">
			<div data-id="react-email-markdown">{{toHtml (joinAlertLabels . "resource" ", ")}}</div>
		  </div>
		</div>
		{{end}}
	  </div>
	  <div style="display:flex;gap:1rem;margin-top:2rem"><a href="{{.DetailUrl}}?ack=1" data-id="react-email-button" target="_blank" style="line-height:100%;text-decoration:none;display:inline-block;max-width:100%;padding:0px 0px"><span></span><span style="max-width:100%;display:inline-block;line-height:120%;mso-padding-alt:0px;mso-text-raise:0"><div style="padding-left:2rem;padding-right:2rem;padding-top:0.5rem;padding-bottom:0.5rem;background-color:rgb(108,83,177);border-radius:0.25rem;font-size:1rem;line-height:1.5rem;color:rgb(255,255,255);font-weight:600;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms">Acknowledge</div></span><span></span></a><a href="{{.DetailUrl}}" data-id="react-email-button" target="_blank" style="color:#61dafb;line-height:100%;text-decoration:none;display:inline-block;max-width:100%;padding:0px 0px"><span></span><span style="max-width:100%;display:inline-block;line-height:120%;mso-padding-alt:0px;mso-text-raise:0"><div style="padding-left:2rem;padding-right:2rem;padding-top:0.5rem;padding-bottom:0.5rem;background-color:rgb(255,255,255);border-width: 1px;border-style:solid;border-color:rgb(229,231,235);border-radius:0.25rem;font-size:1rem;line-height:1.5rem;color:rgb(0,0,0);font-weight:600">View Details</div></span><span></span></a></div>
	</div>
	<div style="display:flex;justify-content:flex-end;align-items:flex-end;margin-top:2rem">
	  <div style="font-size:0.875rem;line-height:1.25rem;font-weight:500">ALL RIGHTS RESERVED ¬© Beijing Flashcat Cloud Technology Co.,Ltd.</div>
	</div>
  </body>

</html>
```

As shown in the image below:

<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/email_render.png" alt="drawing" style="display: block; margin: 0 auto;" width="500"/>

</div>