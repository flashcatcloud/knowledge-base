---
title: "分派策略"
description: "配置告警分派规则，确保故障及时通知到正确的人员"
date: "2024-06-18T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/escalate-rule-settings"
---

分派策略是协作空间的核心配置之一，决定了当故障发生时，系统应该**在什么时间**、**通过什么渠道**、**通知给谁**。

Flashduty 支持灵活的分派模型，不仅支持单聊、群聊通知，还支持多级升级机制，确保重要故障“一定有人处理”。

## 视频介绍
---
<Video width="200" style="width: 140px;" src="https://download.flashcat.cloud/flashduty/video/escalate-rule.mp4"></Video>

## 配置逻辑
---

一条完整的分派策略包含以下四个核心要素，系统将按照从上到下的顺序匹配策略，**一旦匹配成功，即停止匹配后续策略**。

### 1. 触发条件
决定了哪些故障会触发当前策略。

*   **时间过滤**：
    *   **全天候**：默认选项，7x24小时生效。
    *   **特定时间段**：例如仅工作日（周一至周五 9:00-18:00）生效。
    *   **服务日历**：引用预先定义好的[服务日历](https://docs.flashcat.cloud/zh/flashduty/service-calendar)，例如仅“交易日”生效，自动排除法定节假日。

![2025-12-08-16-04-16](https://docs-cdn.flashcat.cloud/images/png/ef94350d04ad4d2889f70bfab0d00426.png)

*   **故障过滤**：
    *   **所有故障**：默认选项。
    *   **按属性匹配**：支持根据故障的**标题**、**级别**（如仅 Critical）、**标签**（如 `service=payment`）进行精准过滤。

![2025-12-08-16-04-32](https://docs-cdn.flashcat.cloud/images/png/0b1982476c0e5445a75b6304bb51c7ed.png)

### 2. 分派对象
决定了通知发送给谁。

*   **值班表（推荐）**：动态分派给当前正在值班的人员。支持多选。
*   **团队**：分派给整个团队的所有成员。
*   **个人**：固定分派给特定人员。
*   **组合模式**：您可以同时选择上述多种对象。

:::tip 动态分派
如果您希望根据告警内容动态路由到负责人（例如根据 `owner` 标签自动分派），请参考 [动态通知](https://docs.flashcat.cloud/zh/flashduty/dynamic-notifications)。
:::

### 3. 通知渠道
决定了通过什么方式触达用户。

#### 单聊（触达个人）
点对点发送给具体的分派对象，支持电话、短信、邮件、App 推送、IM 私聊（飞书/钉钉/企微）。
*   **遵循个人偏好（推荐）**：系统只负责生成任务，具体怎么通知（比如白天用 App，晚上用电话），由成员在[个人中心](https://docs.flashcat.cloud/zh/flashduty/preference-settings)自行配置。
*   **遵循统一设置**：强制规定通知方式（如必须发送短信），覆盖成员的个人偏好。

#### 群聊（触达群组）
发送到即时通讯软件的群组中，支持 @ 提到相关人员。
*   **IM 应用群**：支持飞书、钉钉、企业微信群。需要先完成[IM集成](https://docs.flashcat.cloud/zh/flashduty/lark-integration-guide)。
*   **群机器人**：支持飞书、钉钉、企业微信等 Webhook 机器人。[了解更多](https://docs.flashcat.cloud/zh/flashduty/notifications)

### 4. 升级机制
这是确保故障闭环的关键机制。当第一层级的处理人没有响应或处理完成时，系统会自动升级到下一层级。

*   **升级条件**：
    *   **超时未认领**：故障触发后 N 分钟无人认领。
    *   **超时未关闭**：故障触发后 N 分钟未解决。
*   **典型场景**：
    *   **一线 -> 二线**：一线值班（SRE） 15分钟未响应 -> 升级给二线研发专家。
    *   **主备升级**：主值班人 10分钟未响应 -> 升级给备值班人。
    *   **层层上报**：技术人员 30分钟未解决 -> 升级给技术主管 -> 升级给 CTO。


## 最佳实践
---

1.  **兜底策略**：建议在列表底部保留一条**无过滤条件**的默认策略，分派给SRE团队或管理员，防止因过滤规则配置失误导致故障“漏单”。
2.  **避免过度打扰**：
    *   对于 `Info` / `Warning` 级别的低优告警，建议仅发送 IM 消息，不使用电话/短信。
    *   利用**循环通知**功能时需谨慎，避免产生“告警轰炸”。
3.  **合理拆分空间**：不要试图用一个协作空间管理全公司的所有告警。按功能模块或团队拆分空间，每个空间维护独立且简单的分派策略，是降低维护成本的关键。

## 常见问题
---

<details>
<summary>有告警产生，但没有收到通知怎么排查</summary>
前往 故障详情=>时间线, 查看触发通知流程中的各个渠道通知状态是否正常，如果失败会有失败信息供参考，更多原因可以联系技术支持进行协助排查。
</details>

<details>
<summary>为什么通知方式与我的个人偏好设置不符？</summary>
Flashduty单聊通知渠道支持两种设定，一种是“遵循个人偏好”，一种是“遵循统一设定”。仅在“遵循个人偏好”设定下，会按照您的设置进行个性化通知。

前往 协作空间详情=>分派策略 中，查看您的具体设定。
</details>