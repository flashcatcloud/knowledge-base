---
title: "企微告警集成"
description: "在 Flashduty 生成唯一的企微机器人地址，通过企微的方式将告警的发生与恢复同步到 Flashduty"
date: "2025-05-19T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/wecom-alert-integration-guide"
---

在 Flashduty 生成唯一的企微机器人告警地址，通过企微机器人告警地址将告警的发生与恢复同步到 Flashduty。

<div class="hide">

## 操作步骤
---

### 创建企微告警集成

您可通过以下2种方式，获取一个企微机器人告警集成地址，任选其一即可。

#### 使用专属集成

当您不需要将告警事件路由到不同的协作空间，优先选择此方式，更简单。

<details>
  <summary>展开</summary>
  
  1. 进入 Flashduty 控制台，选择 **协作空间**，进入某个空间的详情页面
  2. 选择 **集成数据** tab，点击 **添加一个集成**，进入添加集成页面
  3. 选择 **企微告警** 集成，点击 **保存**，生成卡片。
  4. 点击生成的卡片，可以查看到 **企微告警集成地址**，复制备用，完成。
    
</details>

#### 使用共享集成

当您需要根据告警事件的 Payload 信息，将告警路由到不同的协作空间，优先选择此方式。

<details>
  <summary>展开</summary>
  
  1. 进入 Flashduty 控制台，选择 **集成中心=>告警事件**，进入集成选择页面。
  2. 选择 **企微告警** 集成：
        - **集成名称**：为当前集成定义一个名称。
        - **消息类型**：选择企微告警消息类型，目前仅支持 Text、Markdown。
        - **推送模式**：选择企微告警在何种情况下触发或恢复告警。
  3. 复制当前页面的 **企微告警集成地址** 备用。
  4. 配置默认路由，并选择对应的协作空间（集成创建后可以前往 `路由` 进行更多路由规则的配置）。
  5. 完成。
    
</details>
</div>

### 定制企微告警集成

#### 企微告警集成地址

系统会帮您生成一个唯一的企微告警集成地址，该地址兼容企微机器人消息的协议，在有的平台仅支持企微机器人通道时，您可以使用该地址来接收对应的消息。

#### 推送模式

默认系统总是为每一条消息创建新的告警，但您可以切换模式为：

**根据规则触发或关闭告警**：该模式下，每当接收到新消息，系统会根据您的规则进行消息匹配，匹配到的消息按照规则去触发新告警或关闭已有告警。

   - 您至少需要填写一条**触发**规则；
   - 您必须设置 Alert Key 的正则提取规则。系统使用该字段来查找历史告警，以便对其进行更新或关闭；**如果正则提取失败，系统将随机来生成 Alert Key**，以确保告警不会因为配置错误而丢失；
   - 您可以选择，当所有的规则都不匹配时，是否丢弃消息。

   配置示例：

   - 接收所有消息，当消息内容中包含 **RESOVED** 字样时，关闭告警，否则触发新告警；
   - Alert Key 从消息内容中提取，规则为 **/(.\*)/**。


### 注意事项
- 企微告警集成地址仅支持接收 Text、Markdown 消息类型，其他消息无法接收。
- Flashduty 会生成默认告警标题： “企微机器人告警”，如果您需要更改标题，可以通过[告警处理 Pipeline](https://docs.flashcat.cloud/zh/flashduty/alert-pipelines) 来自定义标题。

## 严重程度映射关系
---

当前企微告警集成推送到 Flashduty 的严重程度均为Warning，但您可以通过[告警处理 Pipeline](https://docs.flashcat.cloud/zh/flashduty/alert-pipelines) 来自定义严重程度。