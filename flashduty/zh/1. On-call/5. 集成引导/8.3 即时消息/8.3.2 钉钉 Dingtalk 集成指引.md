---
title: "钉钉集成"
description: "通过集成钉钉自建应用，实现在钉钉端内接收和响应告警的能力"
date: "2025-05-19T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/dingtalk-integration-guide"
---

通过集成钉钉自建应用，您可以在钉钉端内接收和响应告警。

> 本文档以钉钉开放平台新版为例。

<div class="hide">

## 视频介绍

---

<Video src="https://download.flashcat.cloud/flashduty/video/dingding.mp4"></Video>

</div>

## 一、创建钉钉应用与添加钉钉集成

---

### 1. 创建自建应用

访问 [钉钉开发者后台](https://open-dev.dingtalk.com/fe/app) → 应用开发 → **企业内部开发**，创建应用。

详见钉钉开发文档 [创建企业内部应用-H5 微应用](https://open.dingtalk.com/document/orgapp/microapplication-creation-and-release-process#title-ovn-666-1ty)。

![2025-09-10-17-05-48](https://docs-cdn.flashcat.cloud/images/png/aa658afccbf0e92e25071143c792955f.png)

应用图标可使用 [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png)。

### 2. 复制企业 `CorpId`

点击页面右上角企业头像，在下拉菜单中复制 `CorpId`。

![2025-09-10-17-07-19](https://docs-cdn.flashcat.cloud/images/png/b94a0f4ab5409f02f14063de03e4502a.png)

回到 Flashduty 集成配置页面，在表单中填入对应的 `CorpId`。

### 3. 复制应用凭证信息

进入创建的应用详情界面，通过左侧菜单栏前往 应用能力 → **凭证与基础信息** 页面，复制 `AgentId`、`Client ID` 和 `Client Secret`。

![2025-09-10-17-10-00](https://docs-cdn.flashcat.cloud/images/png/ac8765ffb106678e1c1a1217e8148567.png)

回到 Flashduty 集成配置页面，在表单中填入对应的 `AgentId`、 `Client ID` 和 `Client Secret`。

### 4. 复制事件订阅信息

前往 开发配置 → **事件订阅** 页面。设置推送方式为 `HTTP推送`，然后点击按钮生成 `加密 aes_key` 和 `签名 Token`，并复制保存。

![2025-09-10-17-11-19](https://docs-cdn.flashcat.cloud/images/png/9a6a52e5802cc75578335730481b2747.png)

回到 Flashduty 集成配置页面，在表单中填入对应的 `加密 aes_key` 和 `签名 Token`，点击 **保存** 按钮。

### 5. 配置事件订阅

进入 开发配置 → **事件订阅** 页面。

根据 Flashduty 集成详情中的 `事件订阅请求地址`，配置 **事件订阅请求网址**。配置完成后 **保存**。

![2025-09-10-17-14-22](https://docs-cdn.flashcat.cloud/images/png/ad81265339dc1ce50f6a6cb2c4321ee0.png)

在 **保存** 按钮下方，选中 `群会话更换群名称`、`群内安装酷应用` 和 `群内卸载酷应用` 三种群会话事件，配置完成后点击 **保存**。

<img src="https://download.flashcat.cloud/dingtalk-self-app-event-subscribe-1.png" alt="drawing" width="500"/>

### 6. 添加应用能力

<img src="https://download.flashcat.cloud/dingtalk-self-app-add.png" alt="drawing" width="500"/>

创建酷应用。进入 酷应用 → **酷应用列表** 页面，点击 **创建酷应用** 按钮，选择 **扩展到群会话**。

<img src="https://download.flashcat.cloud/dingtalk-self-coolapp-create-1.png" alt="drawing" width="500"/>

进入 **编辑酷应用** 页面，完成以下步骤：

1. 填写基本信息。图标可使用 [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png)。

<img src="https://download.flashcat.cloud/dingtalk-self-coolapp-create-baseinfo.png" alt="drawing" width="500"/>

2. 配置功能设计。在左侧选中 **群快捷入口** 和 **消息卡片**。群快捷入口图标可使用 [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png)，桌面和移动端访问地址请复制集成详情里的 **酷应用网页地址**。

<img src="https://download.flashcat.cloud/dingtalk-self-coolapp-create-design.png" alt="drawing" width="500"/>

3. 跳过第三步功能开发，进入第四步 **预览发布**，点击 **发布** 按钮并确认。

### 7. 配置机器人与消息推送

进入 应用能力 → **机器人** 页面，打开机器人配置，填写名称并上传图标，然后点击 **保存**。图标可使用 [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png)。

<img src="https://download.flashcat.cloud/dingtalk-self-app-robot-1.png" alt="drawing" width="500"/>

### 8. 配置应用地址

进入 应用能力 → **网页应用** 页面。

根据 Flashduty 集成详情中的 `应用首页地址` 和 `PC 端首页地址`，配置 **应用首页地址** 和 **PC 端首页地址**。完成后点击 **保存**。

<img src="https://download.flashcat.cloud/dingtalk-self-app-developinfo-1.png" alt="drawing" width="500"/>

### 9. 申请应用权限

进入 开发配置 → **权限管理** 页面，为先前步骤创建的群应用申请以下权限：

- `qyapi_chat_manage`：获取群聊信息
- `qyapi_robot_sendmsg`：向群聊或个人发送消息

![2025-09-10-16-47-06](https://docs-cdn.flashcat.cloud/images/png/3d16611b7a2131192808988c64d13585.png)

## 二、配置作战室

> 若您无需配置作战室功能，可跳过本步骤，直接进入 [**应用发布与使用**](#publish)。

<span id="war-room-scope"></span>

### 1. 申请应用权限

进入 开发配置 → **权限管理** 页面，为先前步骤创建的群应用申请以下权限：

- `qyapi_chat_read`：获取群聊信息
- `qyapi_chat_base_read`：获取群聊信息
- `qyapi_get_member_by_mobile`：允许当前应用根据手机号获取钉钉用户以便邀请用户加入群聊

![2025-09-10-16-46-05](https://docs-cdn.flashcat.cloud/images/png/f85793aff8f1d97fe0c6e0259b14e2d7.png)

### 2. 配置群模板

通过钉钉开放平台顶部菜单栏，前往 开放能力 → **场景群**。

1. 配置 **群机器人**。在左侧菜单栏中选择 **机器人**，然后点击 **创建群机器人**。

   > 本步骤中配置的 **群机器人** 和 **应用机器人** 是两个不同的概念。群机器人被用于在生成群聊时自动创建群机器人。群机器人和应用机器人拥有不同的 **机器人 ID**。若要为钉钉开启作战室功能，必须额外配置 **群机器人**。

   填写群机器人配置。**消息回调地址**、**消息回调 token**、**信息来源网站** 三项配置在 Flashduty 的应用场景中并无实际作用，您可选择任意满足要求的值进行配置。

   **示例配置**：

   | **配置项**     | **值**                                                                            |
   | -------------- | --------------------------------------------------------------------------------- |
   | 机器人名称     | Flashduty                                                                         |
   | 机器人头像     | [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png) |
   | 简介           | Flashduty                                                                         |
   | 消息预览图     | [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png) |
   | 详细描述       | Flashduty 消息推送机器人。                                                        |
   | 消息回调地址   | `https://flashcat.cloud/`                                                         |
   | 消息回调 token | `token`                                                                           |
   | 信息来源网站   | `https://flashcat.cloud/`                                                         |

   完成配置后，点击 **创建**，然后点击 **审批**。右上角弹出 “提交成功” 后，钉钉已自动完成群机器人的审批。

   ![2025-09-10-15-36-24](https://docs-cdn.flashcat.cloud/images/png/ada57d1f58c50250ee2136a08bf3093c.png)

2. 配置 **群模板**。在左侧菜单栏中选择 **群模板**，点击 **创建群模板**。

   将 **企业类型** 设置为 `企业内部`，将 **可选应用** 设置为先前步骤创建的自建应用。然后，在下一步骤中填写模板信息。

   **模板名称**、**图标**、**描述**、**文案介绍**、**模板描述**、**图片介绍** 等介绍性信息不会影响群模板功能的使用，您可选择任意满足要求的值进行配置。

   **示例配置**：

   | **配置项** | **值**                                                                            |
   | ---------- | --------------------------------------------------------------------------------- |
   | 模板名称   | Flashduty 作战室                                                                  |
   | 图标       | [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png) |
   | 描述       | 为活跃故障一键创建作战室。                                                        |
   | 文案介绍   | 为活跃故障一键创建作战室。                                                        |
   | 模板描述   | 为活跃故障一键创建作战室。                                                        |
   | 图片介绍   | [Flashduty 官方 icon](https://download.flashcat.cloud/flashcat_logo_circular.png) |

   在 **选择机器人** 配置项中，点击 **选择已创建的机器人**，选择上一步骤中创建的群机器人。其他配置项保持默认。最后点击 **保存编辑**。

   ![2025-09-10-15-42-04](https://docs-cdn.flashcat.cloud/images/png/04f734bb11ed708208c05af5540082fe.png)
   ![2025-09-10-15-42-45](https://docs-cdn.flashcat.cloud/images/png/1a29b155159c0386d51e65f50faa7827.png)

   在 **填写灰度群** 步骤中，点击 **创建灰度群**，然后点击 **发布灰度**。

   最后，再次点击左侧菜单栏的 **群模板**，然后点击进入刚才创建的群模板。点击 **提交审核**，待钉钉自动通过审核后，最后点击 **发布**。

3. 在已经发布的群模板详细信息页，复制 **模板 ID** 和 **机器人 ID**。

   ![2025-09-10-15-45-42](https://docs-cdn.flashcat.cloud/images/png/3a7750ec7d7cfa05abfe4b8f3f8443fa.png)

   回到 Flashduty 集成配置页面，在表单中填入对应的 `模版 ID` 和 `机器人 ID`，点击 **保存** 按钮。

<span id="publish"></span>

## 三、应用发布与使用

---

完成上述步骤后，前往 应用发布 → **版本管理与发布**，创建新版本并发布。

> 为了确保所有人可以使用应用，需将应用 **可见范围** 调整为全部员工，再进行应用发布。

<img src="https://download.flashcat.cloud/dingtalk-self-app-version.png" alt="drawing" width="500"/>
<img src="https://download.flashcat.cloud/dingtalk-self-app-release-1.png" alt="drawing" width="500"/>

应用发布后，即可通过 **手机端** 或 **PC 端** 访问应用。首次访问需要登录并关联钉钉与 Flashduty 账号，后续可以免登录使用。

- **手机端**：通过 钉钉 → 工作台 → 搜索应用名称 → **打开应用** 使用网页应用。
- **PC 端**：通过 钉钉 → 工作台 → 搜索应用名称 → **打开应用** 使用网页应用。

## 四、常见问题

---

1. **消息无法投递到个人，操作记录提示 `未关联应用`？**
   - 前往 钉钉 → 工作台 → 搜索应用名称 → **打开应用**，完成一次登录以关联钉钉与 Flashduty 账号，系统才能获取用户身份并推送消息。
2. **消息卡片按钮点击无效或报错？**
   - 前往 钉钉 → 工作台 → 搜索应用名称 → **打开应用**，完成一次登录以关联钉钉与 Flashduty 账号。如果已经登录过，尝试点击右上角菜单，切换账户，重新登录来绑定账号。
   - 确保您已购买足够的 License。已使用 License 情况，可以在 控制台 → [**费用中心**](https://console.flashcat.cloud/wallet) 查看。
3. **分派策略钉钉群聊列表为空？**
   - 前往钉钉，选择群聊会话安装酷应用，否则无法获取群聊列表。

   <img src="https://download.flashcat.cloud/flashduty/doc/zh/fd/dingtalk-install-1.png" alt="drawing" width="800"/>
   <img src="https://download.flashcat.cloud/flashduty/doc/zh/fd/dingtalk-install-2.png" alt="drawing" width="800"/>

   - 回到分派策略配置页面，刷新后重新选择群聊列表。
   - 如果仍然无法获取群聊列表，请尝试在群内卸载酷应用后，重试以上步骤。如果问题依旧，请联系客户或专属技术支持。

4. **为什么作战室功能未按预期工作？**
   - 请再次检查是否为应用配置了作战室功能[所需权限](#war-room-scope)。
   - 请参考 Flashduty [作战室介绍文档](https://docs.flashcat.cloud/zh/flashduty/war-room) 的 **常见问题** 部分。

5. **钉钉自建应用 API 调用量？**

   | **钉钉版本** | **调用总量/月** | **QPS** | **刷新时间** |
   | :----------: | :-------------: | :-----: | :----------: |
   |    标准版    |    10,000 次    |   20    |  每月 1 日   |
   |    专业版    |     50 万次     |   40    |  每月 1 日   |
   |    专属版    |    550 万次     |   60    |  每月 1 日   |

   > 超出 API 调用量限制后，钉钉应用将无法正常推送消息。建议合理使用通知渠道。详见 [钉钉官方文档](https://open.dingtalk.com/document/orgapp/descriptions-about-adjusting-limit-and-frequency-of-api-calls?spm=ding_open_doc.document.0.0.6f6b21d9WtkxJI)。
