---
title: "企业微信 WeCom 集成"
description: "通过集成企业微信第三方应用，实现在企业微信端接收和响应告警的能力"
date: "2025-05-19T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/wecom-integration-guide"
---

通过集成企业微信应用，您可以在企业微信端内接收和响应告警。

本文档支持 [集成第三方应用](#third-party) 或 [集成企业自建应用](#self) 两种方式。

<div class="hide">

## 视频介绍

---

<Video src="https://download.flashcat.cloud/flashduty/video/wechat.mp4"></Video>

</div>

> **集成第三方应用** 和 **集成自建应用** 两种方式只需按需配置其中一种。

<span id="third-party"></span>

## 一、集成第三方应用

---

> Flashduty 作为企业微信服务商，为您提供 Flashduty 应用的长期免费版本。该应用需要获得企业微信接口调用许可才能使用（免密登录 + 消息发送）。
>
> 该许可目前支持 **最多 60 天** 免费，超出该使用时长后，Flashduty 需要为您购买企业微信许可，您方可继续使用。

1. 访问 [企业微信管理后台](https://work.weixin.qq.com/wework_admin/frame#apps)，进入 应用管理 → **应用** 页面，点击 **添加第三方应用**。

   ![2025-09-18-11-36-22](https://docs-cdn.flashcat.cloud/images/png/ae4d35a354aaf22dd41b7493200517bc.png)

2. 在搜索栏输入 `Flashduty`，检索到应用后，点击 **添加** 按钮。

   ![2025-09-18-11-38-57](https://docs-cdn.flashcat.cloud/images/png/77347db478c45f4c9d238d587d323a78.png)

3. 修改应用 **可见范围**，推荐选择全员或具体部门节点，以避免新增企业成员时仍需修改。然后，点击 **同意以上授权并添加** 完成安装。

   ![2025-09-18-12-05-07](https://docs-cdn.flashcat.cloud/images/png/0821d1afdeb5db34c4c9b5548d5c8ca1.png)

4. 访问 [企业微信管理后台](https://work.weixin.qq.com/wework_admin/frame#apps)，进入 **我的企业** 页面，获取 `企业 ID`。

    ![2025-09-18-11-44-54](https://docs-cdn.flashcat.cloud/images/png/c032dc755a72550d57658dd5962dafe4.png)

5. 返回 Flashduty 集成配置页面，填写上一步获取的 `企业 ID`，点击 **保存** 完成集成。

<span id="self"></span>

## 二、集成企业自建应用

---

1. 访问 [企业微信管理后台](https://work.weixin.qq.com/wework_admin/frame#apps)，进入 应用管理 → **应用** 页面，点击 **创建应用**。

   ![2025-09-18-11-46-44](https://docs-cdn.flashcat.cloud/images/png/ed274f6a897b808678a5a29b23adcb66.png)

2. 配置 **应用 Logo**、**应用名称** 和 **应用可见范围**。

   ![2025-09-18-11-49-18](https://docs-cdn.flashcat.cloud/images/png/26ec124891e580a6d1e1035ba52636ba.png)

3. 返回 Flashduty 集成配置页面，根据您的实际情况选择企业微信是否为 `非私有化部署版本`。

   若您的企业微信为私有化部署版本，则需要在配置页面中填写 `Endpoint`。此地址需要能够被 Flashduty 服务访问，您可以考虑为其设置 **白名单授权**。

4. 访问 [企业微信管理后台](https://work.weixin.qq.com/wework_admin/frame#apps)，进入 **我的企业** 页面，获取 `企业 ID`，并将其填写至 Flashduty 集成配置页面。

5. 返回 [企业微信管理后台](https://work.weixin.qq.com/wework_admin/frame#apps)，进入 **应用管理** 页面，点击您所创建的应用进入详情页。获取页面中的 `AgentId`，并将其填写至 Flashduty 集成配置页面。

6. 在应用详情页，获取 `Secret`，并将其填写至 Flashduty 集成配置页面。

7. 在应用详情页，进入 **网页授权及 JS-SDK** 页面，点击 **设置可信域名**，并按要求配置 **可作为应用 OAuth 2.0 网页授权功能的回调域名**。

   > 可信域名需要指向 Flashduty 的后端地址 `{api_host}`（可通过 CNAME 或代理转发实现）。
   >
   > 关于可信域名的要求，详见企业微信官方文档 [《企业内部开发配置域名指引》](https://open.work.weixin.qq.com/wwopen/common/readDocument/40754)。

   ![2025-09-18-11-51-26](https://docs-cdn.flashcat.cloud/images/png/5a07bc5e55edf4bb19b142dfbc83f653.png)

   返回 Flashduty 集成配置页面，填写该域名，并完成验证。

8. 在应用详情页，进入 **接收消息** 页面，并 **设置 API 接收**。分别对 `Token` 和 `EncodingAESKey` 点击 **随机获取**，然后复制并保存所生成的值。

   ![2025-09-18-11-58-45](https://docs-cdn.flashcat.cloud/images/png/919bd2722c75513ce1d301779b39c3bf.png)

   返回 Flashduty 集成配置页面，填写已保存的 `Token` 和 `EncodingAESKey`，点击 **保存** 完成集成。

9. 复制 Flashduty 集成详情页中的 `回调地址`，返回企业微信刚才的 **接收消息** 页面。在 **API 接收** 设置中，填入该 `回调地址` 以及上一步保存的 `Token` 和 `EncodingAESKey`，然后点击 **保存**。

    ![2025-09-18-11-56-43](https://docs-cdn.flashcat.cloud/images/png/c990c27f7ad90af172e159fc4acfead7.png)

## 三、配置作战室

---

> 作战室功能仅支持在 **企业自建应用** 模式下开启。

完成先前步骤后，在 Flashduty 集成配置页面的 **增强功能** 模块，勾选 **开启作战室** 即可启用该功能，无需额外配置。

## 四、常见问题

---

1. **点击集成保存按钮后，系统报错 `authorize app first`？**
   - 请检查您是否已完成应用的安装步骤。例如，您是否可以在企业微信工作台中看到 Flashduty 应用。
   - 请检查您是否正确配置了 `Corp ID`。
2. **如何完成账户关联或消息发送提示 `未关联应用`？**
   - 登录企业微信客户端（桌面端和移动端均可），进入 **工作台**，找到并打开 Flashduty 应用。
   - 首次进入应用需要登录。选择您的成员账号，通过密码或单点登录方式登入成功后，即可完成 Flashduty 账号与企业微信账号的关联。
   - 后续进入应用将自动免密登录。
3. **如何发送故障通知？**
   - 发送通知前，必须参照上一问题完成账户关联。
   - 进入指定协作空间，导航至 `分派策略` → **个人渠道**，选择 `企业微信` 作为通知方式即可。
   - Flashduty 支持对企业微信通知内容进行自定义。您可以前往 **模板管理** 页面，设定自定义模板。**自定义区域最多可展示 8 行**，超出部分将被企业微信截断。
   ![2025-09-18-12-02-26](https://docs-cdn.flashcat.cloud/images/png/9cb6a325b4b16875fec3e0c5054be25b.png)

4. **如何在企业微信内处理告警？**
   - 点击卡片消息，可直接进入告警详情页面。
   - 点击 **开始处理**，可直接将告警置为 `处理中` 状态。
   - 点击 **直接关闭**，可直接将告警置为 `已关闭` 状态。
   - 点击 **屏蔽 2 小时**，可直接将告警屏蔽 2 小时。如果想屏蔽更长时间，可点击卡片右上角的 `...` 查看更多屏蔽选项。
5. **为什么卡片消息提供了 `状态刷新` 按钮？**
   - 根据企业微信的限制，一次卡片交互后，72 小时内只可更新一次。每一次按钮操作，都视为一次交互。
   - 当告警状态发生变化时，Flashduty 会请求更新卡片内容。
   - 当告警状态频繁变化时，可能因超出更新次数限制导致卡片无法实时更新。此时，您可以点击 **刷新** 按钮，手动获取一次更新卡片状态的机会。
6. **在 Mac 桌面端，如何设置点击卡片消息时使用 `系统默认浏览器` 打开？**
   - Mac 桌面端默认使用企业微信的内置浏览器打开链接。
   - 您可以尝试使用快捷键 `ctrl` + `command` + `shift` + `d` 开启调试模式，然后选择 **调试** → **浏览器、webView 相关** → **系统浏览器打开网页**，来更改链接的打开方式。使用相同的快捷键可以关闭调试模式，设置将会保留。
7. **故障通知失败，并提示 `未开通企微许可`？**
   - 请联系 Flashduty 客服或您的专属技术支持，为您购买并开通许可。
8. **为什么作战室功能未按预期工作？**
   - 请参考 Flashduty [作战室介绍文档](https://docs.flashcat.cloud/zh/flashduty/war-room) 的 **常见问题** 部分。
