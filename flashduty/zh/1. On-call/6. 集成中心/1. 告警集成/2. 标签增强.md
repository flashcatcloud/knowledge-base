---
title: "配置标签增强"
description: "为告警动态添加、提取或映射标签，丰富故障上下文信息"
date: "2025-12-16T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/label-enrichment-settings"
---

标签增强可在告警接入时自动生成新标签，弥补源数据不足。例如：从描述中提取 IP、将资源 ID 映射为可读名称、组合多个字段生成跳转链接。

## 视频介绍
---

<Video width="200" style="width: 140px;" src="https://download.flashcat.cloud/flashduty/video/label-enrichment.mp4"></Video>

## 核心用途
---

标签贯穿 Flashduty 的告警处理全流程：

| 场景 | 用途 |
| :--- | :--- |
| **故障筛选** | 在故障列表按标签快速过滤 |
| **路由分发** | 根据标签将告警路由到不同协作空间 |
| **分派通知** | 按标签匹配不同的分派策略 |
| **告警聚合** | 按标签维度聚合相似告警 |
| **静默/抑制** | 按标签匹配需要静默或抑制的告警 |

## 配置标签增强
---

进入 集成详情 → **标签增强** → **添加规则**。

### 增强类型

| 类型 | 说明 | 示例 |
| :--- | :--- | :--- |
| **提取** | 用正则从标题/描述/标签中提取内容 | 从描述中提取 IP 地址 |
| **组合** | 用模板语法拼接新标签 | 组合域名+事件 ID 生成日志链接 |
| **映射** | 通过映射表将值转换为可读名称 | 将资源 ID 映射为资源类型 |
| **删除** | 移除指定标签 | 删除敏感信息标签 |

![2025-09-22-13-51-18](https://docs-cdn.flashcat.cloud/images/png/c833e4ac159c9abaea755bad701d95ac.png)

### 配置选项

| 选项 | 说明 |
| :--- | :--- |
| **限制条件** | 仅对匹配条件的告警生效，详见 [配置过滤条件](https://docs.flashcat.cloud/zh/flashduty/how-to-filter) |
| **覆盖** | 开启后覆盖同名标签，默认关闭 |
| **预览** | 使用真实告警预览规则效果 |

![2025-12-16-17-19-35](https://docs-cdn.flashcat.cloud/images/png/c833e4ac159c9abaea755bad701d95ac.png)

:::tip
多条规则从上到下依次执行。规则不匹配时跳过，不会生成对应标签。
:::

## 配置示例
---
### 1. **标签提取**
 **场景：** 告警事件来自邮件集成，需要从描述信息中提取关键信息作为标签应用到其他场景，比如将描述信息中的 IP 和触发值提取为独立的标签。
#### 1.1告警原文

![2025-09-22-13-51-58](https://docs-cdn.flashcat.cloud/images/png/4a335b5d80a1b5a8ea9460668f2a25d7.png)


#### 1.2 提取规则

![2025-09-22-13-52-13](https://docs-cdn.flashcat.cloud/images/png/eaebc7f494e5b0e955fb381813bace74.png)

#### 1.3 提取效果

![2025-09-22-13-52-27](https://docs-cdn.flashcat.cloud/images/png/33b3f01f2cc7f8b323765b0ed3ee7578.png)


### 2. **标签组合** 
**场景：** 公司的日志平台可以通过域名+事件ID+时间戳的方式直接访问到日志详情，但告警信息中只有事件ID和时间戳标签，所以需要根据这些信息组合成一个访问地址。
#### 2.1 告警原文
![2025-09-22-13-52-42](https://docs-cdn.flashcat.cloud/images/png/7b8eccb938993d2867bf3f7860b0788f.png)

#### 2.2 组合规则

![2025-09-22-13-52-56](https://docs-cdn.flashcat.cloud/images/png/ea29da12647637b5f46667d8205f65b2.png)

#### 2.3 组合效果

![2025-09-22-13-53-09](https://docs-cdn.flashcat.cloud/images/png/7f6cf27203660cbd11ae737ed58a52a4.png)

### 3. **标签映射** 
**场景：** 当源告警信息中的标签值不固定且不能直观定位其含义时可以通过映射的方式，将源标签映射新定义标签和值；比如源告警中只有资源类型ID信息，但希望将每个ID对应的资源类型名称也体现出来，这时可以通过映射实现。

#### 3.1 准备映射表文件（需要CSV格式）
以下为映射表文件示例，目的是将告警中的资源类型ID与实际的资源类型名称进行映射。

| ID | Type |
| :---: | :---: |
| A | server |
| B | router |
| C | gateway |
| D | database |
| E | MQ |

#### 3.2 创建映射表
1. 进入 `集成中心` -> `标签映射` -> `创建标签映射`。
2. 填写基本信息，如名称、描述、管理团队等。
3. 在 `映射表数据` 处，上传准备好的csv文件（如果数量较少，创建完成后，可以在映射详情页面中编辑添加）。
4. 选择`源标签`，如 `ID`，选择`目标标签`，如 `Type`。
5. 点击`创建`，完成映射表创建。

![2025-09-22-13-53-26](https://docs-cdn.flashcat.cloud/images/png/95bc8cdf3d3dcb60a52d11cdad4c386b.png)

#### 3.3 配置映射关系

![2025-09-22-13-53-43](https://docs-cdn.flashcat.cloud/images/png/d25e632242d1a37ce9f159cd3b3086d4.png)

##### 3.3.1 告警原文
上报的告警信息中只有资源ID，没有资源类型名称。

![2025-09-22-13-53-55](https://docs-cdn.flashcat.cloud/images/png/c5e636c149f7125c0bde7e479414e130.png)

##### 3.3.2 映射效果
通过配置的映射关系，将资源ID映射出新的资源类型名称标签。

![2025-09-22-13-54-09](https://docs-cdn.flashcat.cloud/images/png/8f93f6ae82e76e79196b5bf488663fe8.png)

**附：映射表数据管理**

在映射表详情页面中，可以对映射表数据进行管理，包括新增、编辑、删除等操作。
1. 数据搜索：可以按照源标签的值进行搜索。
2. 数据添加：手动添加映射数据。
3. 数据上传：上传新的数据映射表，会覆盖已有数据。
4. 数据下载：下载当前映射表数据到本地。
5. 数据展示：展示当前映射表数据，可以编辑或删除。

![2025-09-22-13-54-23](https://docs-cdn.flashcat.cloud/images/png/477563cfc4e3759e8584edd34fa5bf9a.png)

:::tip API 管理
对于频繁变更的映射关系（如 CMDB 数据同步），建议使用 [Flashduty API](https://developer.flashcat.cloud/api-142429470) 进行自动化更新。
:::

## 下一步
---

- [配置分派策略](https://docs.flashcat.cloud/zh/flashduty/escalate-rule-settings) - 使用标签匹配分派条件
- [配置告警降噪](https://docs.flashcat.cloud/zh/flashduty/noise-reduction-settings) - 使用标签作为聚合维度
- [配置过滤条件](https://docs.flashcat.cloud/zh/flashduty/how-to-filter) - 了解标签匹配语法
