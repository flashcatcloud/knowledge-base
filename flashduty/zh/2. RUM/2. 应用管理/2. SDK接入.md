---
title: "RUM SDK 接入指南"
description: "本文档详细介绍如何在不同场景下接入 Flashduty RUM SDK，包括 CDN 和 NPM 两种方式。"
date: "2024-05-09T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/rum/sdk-integration"
---

## 接入方式

---

Flashduty RUM 提供两种接入方式，您可以根据项目需求选择最适合的方案：

### 1. CDN 方式接入

这是最简单快捷的接入方式，只需在 HTML 中添加以下代码：

```html
<script
  src="https://static.flashcat.cloud/browser-sdk/v3/flashcat-rum.js"
  type="text/javascript"
></script>
<script>
  window.FC_RUM &&
    window.FC_RUM.init({
      applicationId: "YOUR_APPLICATION_ID", // 从应用管理页面获取
      clientToken: "YOUR_CLIENT_TOKEN", // 从应用管理页面获取
      service: "your-service-name", // 服务名称，用于区分不同的服务
      env: "production", // 环境标识
      version: "1.0.0", // 应用版本号
      sessionSampleRate: 100, // 采样率
    });
</script>
```

### 2. NPM 包方式接入

如果您使用现代前端框架（如 React、Vue 等），推荐使用 NPM 包方式接入：

```bash
npm install @flashcat/browser-rum
# 或
yarn add @flashcat/browser-rum
```

然后在应用入口文件中初始化：

```javascript
import { flashcatRum } from "@flashcat/browser-rum";

flashcatRum.init({
  applicationId: "YOUR_APPLICATION_ID", // 从应用管理页面获取
  clientToken: "YOUR_CLIENT_TOKEN", // 从应用管理页面获取
  service: "your-service-name", // 服务名称
  env: "production", // 环境标识
  version: "1.0.0", // 应用版本号
  sessionSampleRate: 100, // 采样率
});
```

## 配置说明

---

### 基础配置项

| 配置项        | 类型   | 必填 | 说明                                |
| ------------- | ------ | ---- | ----------------------------------- |
| applicationId | string | 是   | 应用 ID，在应用管理页面获取         |
| clientToken   | string | 是   | 客户端 Token，在应用管理页面获取    |
| site          | string | 是   | 数据上报站点，如 cn、us 等          |
| service       | string | 是   | 服务名称，用于区分不同的服务        |
| env           | string | 否   | 环境标识，如 production、staging 等 |
| version       | string | 否   | 应用版本号                          |

### 高级配置项

| 配置项                | 类型    | 默认值 | 说明                   |
| --------------------- | ------- | ------ | ---------------------- |
| trackResources        | boolean | true   | 是否追踪资源加载性能   |
| trackLongTasks        | boolean | true   | 是否追踪长任务         |
| trackUserInteractions | boolean | true   | 是否追踪用户交互       |
| sessionSampleRate     | number  | 100    | 会话采样率，范围 0-100 |

## 框架集成

---

### React 应用

```javascript
// App.jsx 或 index.jsx
import { flashcatRum } from "@flashcat/browser-rum";

// 在应用初始化时配置
flashcatRum.init({
  applicationId: "YOUR_APPLICATION_ID",
  clientToken: "YOUR_CLIENT_TOKEN",
  // ... 其他配置
});
```

### Vue 应用

```javascript
// main.js
import { flashcatRum } from "@flashcat/browser-rum";

// 在应用初始化时配置
flashcatRum.init({
  applicationId: "YOUR_APPLICATION_ID",
  clientToken: "YOUR_CLIENT_TOKEN",
  // ... 其他配置
});
```

## 验证接入

---

接入完成后，您可以通过以下步骤验证是否接入成功：

1. 打开浏览器开发者工具，查看 Network 面板中是否有向 Flashduty 的数据上报请求
2. 访问 Flashduty 控制台，查看 RUM 应用数据是否正常显示
3. 触发一些用户交互，验证数据采集是否正常

## 常见问题

---

### 1. 数据上报问题

- **没有数据上报**

  - 检查 applicationId 和 clientToken 是否正确
  - 确认网站是否正常访问
  - 查看浏览器控制台是否有错误

- **数据延迟**
  - 正常情况下数据上报延迟在 1-2 分钟内
  - 如延迟较大，请检查网络状况

### 2. 跨域问题

如果您的网站启用了 CSP，需要添加以下配置：

```html
<meta
  http-equiv="Content-Security-Policy"
  content="default-src 'self' https://static.flashcat.cloud https://browser.flashcat.cloud;"
/>
```

### 3. 广告拦截

某些广告拦截插件可能会影响数据收集，建议：

- 临时禁用广告拦截插件进行测试
- 将 Flashduty 域名添加到白名单

## 下一步

---

完成 SDK 接入后，您可以：

1. [查看性能监控指标](../3. 数据查看/1. 性能指标.md)
2. [配置告警规则](../4. 告警配置/1. 告警规则.md)
3. [分析用户行为](../3. 数据查看/2. 用户行为.md)
