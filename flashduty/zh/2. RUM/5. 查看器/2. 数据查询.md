---
title: "RUM 数据查询语法指南"
description: "掌握 Flashduty RUM 查看器的搜索语法，通过灵活的查询条件快速定位和分析用户数据。"
date: "2024-05-09T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/rum/session-explorer-data-query"
---

## 概述

Flashduty RUM 查看器提供了强大的检索能力，允许您通过灵活的查询语法快速定位和分析 RUM 数据。查询由**词项** (terms) 和**操作符** (operators) 组成，支持复杂的搜索条件组合，帮助您从海量数据中精准找到所需信息。

查询支持两种类型的词项：

1. **单词项** (single term)：单个词汇，如 `test` 或 `hello`
2. **短语** (sequence)：用双引号包围的词汇组，如 `"hello flashduty"`

您可以使用以下布尔操作符组合多个词项构建复杂查询：

| 操作符 | 描述                                                     | 示例                 |
| ------ | -------------------------------------------------------- | -------------------- |
| `AND`  | 交集：两个词项都必须在选定的视图中（默认操作符）         | `error AND timeout`  |
| `OR`   | 并集：任一词项包含在选定的视图中，需要使用 `()` 包裹起来 | `(error OR warning)` |
| `-`    | 排除：后面的词项不在视图中                               | `error -timeout`     |

## 全文检索

:::highlight orange 💡
全文检索仅部分字段支持全文检索，如未查询到结果，请转为字段查询。
:::

您可以通过全文检索来快速查询数据：

| 查询语句      | 描述                            |
| ------------- | ------------------------------- |
| hello         | 精确匹配 `hello` 的字段         |
| hello\*       | 匹配以 `hello` 开头的字段       |
| \*hello       | 匹配以 `hello` 结尾的字段       |
| \*hello\*     | 匹配含有 `hello` 的字段         |
| "hello world" | 精确匹配 `"hello world"` 的字段 |

## 转义特殊字符和空格

检索包含特殊字符的字段值时，需要使用反斜杠 `\` 转义或者双引号。以下字符被视为特殊字符：`:`, `"`, `*`, `-`, `>`, `<`, `,`, `(`, `)`, `[`, `]`, `\` 和空格 (Space)。

## 属性检索

您可以使用 `attribute:term` 来检索特定属性：

| 查询语句                | 描述                             |
| :---------------------- | -------------------------------- |
| browser_name:Chrome     | 检索值为 `Chrome` 的浏览器       |
| view_name:\*/detail     | 检索以 `/detail` 结尾的视图名称  |
| -resource_status_code:0 | 检索状态码不为 `0` 的资源        |
| os_name:"Mac OS X"      | 检索值为 `"Mac OS X"` 的系统名称 |

## 数值检索

对于数值类型的属性，我们可以使用比较操作符 `>` `>=` `<` `<=` 检索：

| 查询语句                    | 描述                                   |
| :-------------------------- | -------------------------------------- |
| session_error_count:>5      | 检索错误数大于 `5` 的会话              |
| view_time_spent:>=1.00min   | 检索停留时间大于 `1min` 的视图         |
| session_view_count:[2 TO 8] | 检索视图访问量在 `2` 和 `8` 之间的会话 |

## 复杂检索

对于复杂的情况，我们可以任意组合条件进行检索。

### 错误分析检索

```
error_message:Warning\:* view_url_path:/wallet/*
```

检索钱包页面中发生的 Warning 类型的错误。

### 性能分析检索

```
view_loading_time:>=5s view_url_path:/incident/detail/*
```

检索加载时间超过 5 秒，且 以 `/incident/detail/` 开头的视图。

### 错误请求分析

```
-resource_status_code:200 resource_type:(fetch OR xhr)
```

检索请求类型为 `fetch` 或者 `xhr`，且状态码不为 `200` 的资源。

### 页面行为分析

```
view_url_path:/incident (view_action_count:>=2 OR view_error_count:>=3)
```

检索 URL 为 `/incident`，且操作数大于 `2` 或者错误数大于 `3` 的视图

## 高级检索技巧

### 1. 时间范围检索

结合时间范围进行精确检索：

```
view_loading_time:>2s client_time:>1758253826081
```

### 2. 用户行为检索

```
action_type:click view_url_path:/checkout/*
```

检索结账页面的用户点击行为。

### 3. 设备类型检索

```
device_type:mobile view_loading_time:>3s
```

检索移动设备上加载时间超过 3 秒的视图。

### 4. 地理位置检索

```
geo_country:China session_error_count:>0
```

检索中国地区发生错误的会话。

## 最佳实践

1. **使用引号包围短语**：确保多词短语的精确匹配
2. **合理使用通配符**：避免过于宽泛的检索条件
3. **组合多个条件**：通过 AND/OR 操作符构建精确查询
4. **保存常用检索**：提高重复查询的效率
5. **利用自动补全**：减少输入错误，提高检索准确性

## 下一步

- [RUM 查看器概览](https://docs.flashcat.cloud/zh/flashduty/rum/rum-explorer)
- [分布式追踪最佳实践](https://docs.flashcat.cloud/zh/flashduty/rum/trace-tracking)
