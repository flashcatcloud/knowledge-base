# 数据收集

## 概述

Real User Monitoring (RUM) 收集以下类型的数据：

- 会话指标和属性
- 视图指标和属性
- 资源指标和属性
- 长任务指标和属性
- 错误指标和属性
- 用户操作指标和属性
- 沮丧信号字段
- UTM 属性

## 默认属性

所有 RUM 事件都包含以下默认属性：

| 属性             | 类型   | 描述                                                                   |
| ---------------- | ------ | ---------------------------------------------------------------------- |
| `date`           | 整数   | 事件的时间戳（以毫秒为单位）。                                         |
| `type`           | 字符串 | 事件的类型（例如，`session`、`view`、`resource`、`error`、`action`）。 |
| `service`        | 字符串 | 生成此事件的服务名称。                                                 |
| `application.id` | 字符串 | 生成此事件的应用程序 ID。                                              |
| `session.id`     | 字符串 | 会话 ID。                                                              |
| `view.id`        | 字符串 | 视图 ID。                                                              |
| `action.id`      | 字符串 | 用户操作 ID。                                                          |
| `context`        | 对象   | 用户定义的上下文。                                                     |

## 事件特定指标和属性

### 会话指标

| 指标                      | 类型 | 描述                           |
| ------------------------- | ---- | ------------------------------ |
| `session.duration`        | 数字 | 会话持续时间（以毫秒为单位）。 |
| `session.view.count`      | 数字 | 会话中的视图数。               |
| `session.action.count`    | 数字 | 会话中的用户操作数。           |
| `session.error.count`     | 数字 | 会话中的错误数。               |
| `session.resource.count`  | 数字 | 会话中的资源数。               |
| `session.long_task.count` | 数字 | 会话中的长任务数。             |

### 会话属性

| 属性                            | 类型   | 描述                                    |
| ------------------------------- | ------ | --------------------------------------- |
| `session.type`                  | 字符串 | 会话类型（例如，`user`、`synthetic`）。 |
| `session.has_replay`            | 布尔值 | 是否启用了会话重放。                    |
| `session.is_active`             | 布尔值 | 会话是否处于活动状态。                  |
| `session.initial_view.id`       | 字符串 | 初始视图 ID。                           |
| `session.initial_view.url`      | 字符串 | 初始视图 URL。                          |
| `session.initial_view.referrer` | 字符串 | 初始视图的引用 URL。                    |

### 视图指标

| 指标                          | 类型 | 描述                               |
| ----------------------------- | ---- | ---------------------------------- |
| `view.loading_time`           | 数字 | 视图加载时间（以毫秒为单位）。     |
| `view.first_contentful_paint` | 数字 | 首次内容绘制时间（以毫秒为单位）。 |
| `view.dom_interactive`        | 数字 | DOM 交互时间（以毫秒为单位）。     |
| `view.dom_complete`           | 数字 | DOM 完成时间（以毫秒为单位）。     |
| `view.load_event_end`         | 数字 | 加载事件结束时间（以毫秒为单位）。 |
| `view.error.count`            | 数字 | 视图中的错误数。                   |
| `view.resource.count`         | 数字 | 视图中的资源数。                   |
| `view.long_task.count`        | 数字 | 视图中的长任务数。                 |
| `view.action.count`           | 数字 | 视图中的用户操作数。               |

### 视图属性

| 属性            | 类型   | 描述             |
| --------------- | ------ | ---------------- |
| `view.url`      | 字符串 | 视图 URL。       |
| `view.referrer` | 字符串 | 视图的引用 URL。 |
| `view.name`     | 字符串 | 视图名称。       |

### 资源指标

| 指标                           | 类型 | 描述                           |
| ------------------------------ | ---- | ------------------------------ |
| `resource.duration`            | 数字 | 资源加载时间（以毫秒为单位）。 |
| `resource.size`                | 数字 | 资源大小（以字节为单位）。     |
| `resource.connect.duration`    | 数字 | 连接时间（以毫秒为单位）。     |
| `resource.ssl.duration`        | 数字 | SSL 握手时间（以毫秒为单位）。 |
| `resource.dns.duration`        | 数字 | DNS 查找时间（以毫秒为单位）。 |
| `resource.first_byte.duration` | 数字 | 首字节时间（以毫秒为单位）。   |
| `resource.download.duration`   | 数字 | 下载时间（以毫秒为单位）。     |

### 资源属性

| 属性                       | 类型   | 描述                                                                                               |
| -------------------------- | ------ | -------------------------------------------------------------------------------------------------- |
| `resource.type`            | 字符串 | 资源类型（例如，`xhr`、`fetch`、`document`、`script`、`css`、`image`、`font`、`media`、`other`）。 |
| `resource.method`          | 字符串 | HTTP 方法（例如，`GET`、`POST`）。                                                                 |
| `resource.status_code`     | 数字   | HTTP 状态码。                                                                                      |
| `resource.url`             | 字符串 | 资源 URL。                                                                                         |
| `resource.provider.name`   | 字符串 | 资源提供者名称。                                                                                   |
| `resource.provider.domain` | 字符串 | 资源提供者域名。                                                                                   |
| `resource.provider.type`   | 字符串 | 资源提供者类型（例如，`first-party`、`third-party`）。                                             |

### 长任务指标

| 指标                 | 类型 | 描述                             |
| -------------------- | ---- | -------------------------------- |
| `long_task.duration` | 数字 | 长任务持续时间（以毫秒为单位）。 |

### 错误指标

| 指标          | 类型 | 描述     |
| ------------- | ---- | -------- |
| `error.count` | 数字 | 错误数。 |

### 错误属性

| 属性            | 类型   | 描述                                                                            |
| --------------- | ------ | ------------------------------------------------------------------------------- |
| `error.source`  | 字符串 | 错误来源（例如，`console`、`network`、`source`、`logger`、`agent`、`custom`）。 |
| `error.type`    | 字符串 | 错误类型。                                                                      |
| `error.message` | 字符串 | 错误消息。                                                                      |
| `error.stack`   | 字符串 | 错误堆栈跟踪。                                                                  |

### 用户操作指标

| 指标                     | 类型 | 描述                               |
| ------------------------ | ---- | ---------------------------------- |
| `action.loading_time`    | 数字 | 用户操作加载时间（以毫秒为单位）。 |
| `action.long_task.count` | 数字 | 用户操作中的长任务数。             |
| `action.resource.count`  | 数字 | 用户操作中的资源数。               |
| `action.error.count`     | 数字 | 用户操作中的错误数。               |

### 用户操作属性

| 属性                 | 类型   | 描述                                      |
| -------------------- | ------ | ----------------------------------------- |
| `action.id`          | 字符串 | 用户操作 ID。                             |
| `action.type`        | 字符串 | 用户操作类型（例如，`click`、`custom`）。 |
| `action.target.name` | 字符串 | 用户操作目标名称。                        |
| `action.name`        | 字符串 | 用户操作名称。                            |

### 沮丧信号字段

| 字段                                  | 类型   | 描述                 |
| ------------------------------------- | ------ | -------------------- |
| `session.frustration.count`           | 数字   | 会话中的沮丧信号数。 |
| `view.frustration.count`              | 数字   | 视图中的沮丧信号数。 |
| `action.frustration.type:dead_click`  | 字符串 | 死点击沮丧信号。     |
| `action.frustration.type:rage_click`  | 字符串 | 愤怒点击沮丧信号。   |
| `action.frustration.type:error_click` | 字符串 | 错误点击沮丧信号。   |

### UTM 属性

| 字段                          | 类型   | 描述           |
| ----------------------------- | ------ | -------------- |
| `view.url_query.utm_source`   | 字符串 | UTM 来源参数。 |
| `view.url_query.utm_medium`   | 字符串 | UTM 媒介参数。 |
| `view.url_query.utm_campaign` | 字符串 | UTM 活动参数。 |
| `view.url_query.utm_content`  | 字符串 | UTM 内容参数。 |
| `view.url_query.utm_term`     | 字符串 | UTM 术语参数。 |

```

```
