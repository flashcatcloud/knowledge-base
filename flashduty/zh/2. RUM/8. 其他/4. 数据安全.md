---
title: "RUM 数据安全"
description: "了解 Flashduty RUM 的数据安全机制和最佳实践，确保用户数据的安全性和隐私保护。"
date: "2024-05-09T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/rum/data-security"
---

## 概述

真实用户监控(RUM)涉及从最终用户的浏览器和移动设备收集数据。为了保护用户隐私和确保数据安全，Flashduty 提供了多种配置选项和工具来管理数据收集、存储和访问。

## 隐私选项

### 客户端令牌

浏览器 RUM 客户端令牌用于将最终用户浏览器的数据与 Flashduty 中的特定 RUM 应用程序匹配。它是未加密的，可以从应用程序的客户端看到。

虽然客户端令牌仅用于向 Flashduty 发送数据，不会造成数据泄露风险，但我们建议采取以下良好的令牌管理措施：

- 定期轮换客户端令牌，确保它只被您的应用程序使用
- 在捕获 RUM 数据时自动过滤掉机器人

#### 认证代理

使用客户端令牌过滤机器人的一种方法是认证代理。在这种方法中，初始化 RUM SDK 时使用占位符字符串替代 `clientToken`。代理知道真实的客户端令牌，但最终用户不知道。

代理配置为在将会话数据传递给 Flashduty 之前检查有效的用户信息，从而确认真实用户已登录并正在传输要监控的流量。接收流量时，代理验证数据是否包含占位符字符串，并在将数据转发给 Flashduty 之前将其替换为真实的 `clientToken`。

### 事件追踪

事件是用户与您的网站或应用程序特定元素的交互。事件可以通过 SDK 自动捕获或通过自定义操作发送。您可以关闭用户交互和页面访问的自动追踪，只捕获您选择的交互。默认情况下，RUM 使用目标内容从 SDK 自动收集的操作生成操作名称。您可以使用任何给定名称显式覆盖此行为。

### 通过代理服务器传输 RUM 事件

您可以通过自己的代理服务器传输所有 RUM 事件，这样最终用户设备就永远不会直接与 Flashduty 通信。

### 用户身份追踪

默认情况下，**不会追踪用户身份**。每个会话都有一个与之关联的唯一 `session.id`，这样可以匿名化数据，但允许您了解趋势。您可以选择编写代码来捕获用户数据（如姓名和电子邮件地址），然后使用该数据来丰富和修改 RUM 会话，但这不是必需的。

### 数据保留

配置事件捕获后，事件将存储在 Flashduty 中。您可以决定捕获的事件和属性在 Flashduty 中保留多长时间。

默认情况下，生产环境的数据保留期为：

- 会话、视图、操作、错误和会话录制保留 30 天
- 资源和长任务保留 15 天

### 个人和敏感数据移除

您可以使用多个选项来移除个人身份信息(PII)和敏感数据，包括 IP 地址和地理位置信息。RUM 中可能出现 PII 的一些场景包括：

- 按钮上的操作名称（例如"查看完整信用卡号码"）
- URL 中显示的名称
- 应用程序开发人员设置的自定义追踪事件

#### 屏蔽操作名称

默认情况下，如果您希望屏蔽所有操作名称，可以结合使用 `enablePrivacyForActionName` 选项和 `mask` 隐私设置。此操作会自动将所有未被覆盖的操作名称替换为占位符 `Masked Element`。此设置还设计为与现有的 HTML 覆盖属性兼容。

#### IP 地址

初始化 RUM 应用程序后，您可以在**用户数据收集**选项卡中选择是否要包含 IP 或地理位置数据。

禁用 IP 数据收集后，更改将立即生效。在禁用之前收集的任何事件不会删除 IP 数据。这是在后端执行的，这意味着浏览器 SDK 仍在发送数据，但 IP 地址在处理时会被 Flashduty 后端管道省略和丢弃。

#### 地理位置

除了删除客户端 IP 外，您还可以选择禁用从所有未来收集的数据中收集地理位置（国家、城市、县）或 GeoIP 信息。如果取消选中**收集地理位置数据**框，更改将立即生效。在禁用之前收集的任何事件不会删除相应的地理位置数据。数据省略在后端级别完成，这意味着浏览器 SDK 仍在发送数据，但地理位置数据在处理时会被 Flashduty 后端管道省略和丢弃。
