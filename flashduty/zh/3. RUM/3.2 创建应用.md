---
title: "RUM 设置"
description: "了解如何为您的Web应用程序设置实时用户监控(RUM)，以跟踪性能和用户体验。"
date: "2024-05-09T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/rum/setup"
---

## 概述
---

要开始使用FlashCat RUM监控Web应用程序，您需要：

1. 在FlashCat控制台中创建RUM应用程序
2. 使用RUM SDK对您的应用程序进行检测

对应用程序进行检测允许收集可观测性数据并在FlashCat UI中显示。

## 创建RUM应用程序
---

1. 登录FlashCat控制台
2. 导航至 **RUM** > **应用程序**
3. 点击 **新建应用程序**
4. 为您的应用程序输入名称（例如，"我的Web应用"）
5. 选择 **浏览器** 作为应用程序类型
6. 点击 **创建**

创建应用程序后，您将获得下一步所需的应用程序ID和客户端令牌。

## 检测您的应用程序
---

有两种方式对您的应用程序进行检测：自动检测或手动检测。

### 自动检测

自动检测是开始使用RUM的最简单方法。它只需要最少的代码更改，并自动跟踪页面视图、资源、错误和用户操作。

1. 将以下脚本添加到您HTML的`<head>`部分：

```html
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'rum.start':
  new Date().getTime(),event:'rum',
  'application_id':'YOUR_APPLICATION_ID',
  'client_token':'YOUR_CLIENT_TOKEN'
  });var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://cdn.flashcat.cloud/rum.js';f.parentNode.insertBefore(j,f);
  })(window,document,'script','fcLayer','YOUR_APPLICATION_ID');
</script>
```

2. 将`YOUR_APPLICATION_ID`和`YOUR_CLIENT_TOKEN`替换为创建RUM应用程序时提供的值。

### 手动检测

手动检测让您对收集的数据和配置方式有更多控制。这推荐用于高级用例或当您需要自定义数据收集时。

1. 通过npm安装RUM SDK：

```bash
npm install @flashcat/rum-browser
```

2. 在您的应用程序中初始化SDK：

```javascript
import { RumBrowser } from '@flashcat/rum-browser';

RumBrowser.init({
  applicationId: 'YOUR_APPLICATION_ID',
  clientToken: 'YOUR_CLIENT_TOKEN',
  site: 'flashcat.cloud',
  service: 'my-web-app',
  env: 'production',
  // 额外配置选项
  trackUserInteractions: true,
  trackResources: true,
  trackLongTasks: true,
  trackErrors: true,
  defaultPrivacyLevel: 'mask-user-input'
});
```

3. 将`YOUR_APPLICATION_ID`和`YOUR_CLIENT_TOKEN`替换为创建RUM应用程序时提供的值。

## 配置选项
---

RUM SDK提供了几个配置选项来自定义数据收集：

| 选项 | 类型 | 默认值 | 描述 |
|--------|------|---------|-------------|
| `applicationId` | string | - | 您的RUM应用程序ID（必需） |
| `clientToken` | string | - | 您的RUM客户端令牌（必需） |
| `site` | string | 'flashcat.cloud' | 发送数据的FlashCat站点 |
| `service` | string | - | 您的服务或应用程序名称 |
| `env` | string | 'production' | 环境（例如，'production'、'staging'、'development'） |
| `version` | string | - | 您的应用程序版本 |
| `trackUserInteractions` | boolean | true | 是否跟踪用户交互（点击等） |
| `trackResources` | boolean | true | 是否跟踪资源加载（图像、脚本等） |
| `trackLongTasks` | boolean | true | 是否跟踪长任务（JavaScript执行 > 50ms） |
| `trackErrors` | boolean | true | 是否跟踪JavaScript错误 |
| `defaultPrivacyLevel` | string | 'mask-user-input' | 收集数据的隐私级别（'allow'、'mask'、'mask-user-input'） |

## 验证安装
---

对应用程序进行检测后，您可以通过以下方式验证数据是否被收集：

1. 在Web浏览器中打开您的应用程序
2. 导航至FlashCat控制台 > RUM > 应用程序 > 您的应用程序
3. 检查"会话"选项卡，查看您的会话是否出现

数据可能需要几分钟才能在控制台中显示。

## 故障排除
---

如果在检测应用程序后在RUM控制台中看不到数据，请检查以下内容：

1. **控制台错误**：打开浏览器的开发者控制台，检查是否有与RUM SDK相关的JavaScript错误。

2. **网络请求**：在浏览器开发者工具的网络选项卡中，查找对`https://rum-intake.flashcat.cloud`的请求，确保它们成功（状态码200）。

3. **应用程序ID和客户端令牌**：验证您在检测代码中使用的应用程序ID和客户端令牌是否正确。

4. **内容安全策略（CSP）**：如果您的站点使用内容安全策略，确保它允许连接到`https://rum-intake.flashcat.cloud`和从`https://cdn.flashcat.cloud`加载脚本。

5. **广告拦截器**：某些广告拦截器可能会干扰RUM数据收集。尝试禁用广告拦截器进行测试。

## 下一步
---

现在您已经为应用程序设置了RUM，您可以：

- [探索RUM仪表板](https://docs.flashcat.cloud/zh/flashduty/rum/exploring-rum-data)分析应用程序的性能
- [配置高级设置](https://docs.flashcat.cloud/zh/flashduty/rum/advanced-configuration)自定义数据收集
- [跟踪自定义用户操作](https://docs.flashcat.cloud/zh/flashduty/rum/tracking-user-actions)获取特定用户交互的洞察
