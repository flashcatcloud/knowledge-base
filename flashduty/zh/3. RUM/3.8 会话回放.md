---
title: "RUM 会话回放"
description: "了解如何使用FlashCat实时用户监控(RUM)的会话回放功能查看和分析用户与您的Web应用程序的交互。"
date: "2024-05-09T10:00:00+08:00"
url: "https://docs.flashcat.cloud/zh/flashduty/rum/session-replay"
---

## 概述
---

会话回放是FlashCat RUM的强大功能，允许您观看用户与您的Web应用程序交互的录像。这提供了对用户体验的独特洞察，帮助您识别可用性问题、理解用户行为模式并更快地调试问题。

## 会话回放的价值
---

会话回放提供了几个关键优势：

1. **可用性洞察**：直接观察用户如何与您的界面交互，识别混淆点和摩擦区域。

2. **错误上下文**：查看导致错误的确切用户操作和上下文，使调试更容易。

3. **用户旅程可视化**：了解用户如何在您的应用程序中导航，识别复杂或低效的路径。

4. **转化优化**：分析成功和放弃的转化流程，了解差异。

5. **支持增强**：查看用户报告的问题的确切会话，提供更好的支持。

## 启用会话回放
---

会话回放默认为启用状态，但您可以通过SDK配置自定义其行为：

```javascript
RumBrowser.init({
  // ... 其他配置选项
  sessionReplayEnabled: true,       // 启用会话回放
  replaySampleRate: 20,             // 录制20%的会话
  defaultPrivacyLevel: 'mask-user-input', // 隐私级别
});
```

### 配置选项

| 选项 | 类型 | 默认值 | 描述 |
|--------|------|---------|-------------|
| `sessionReplayEnabled` | boolean | true | 是否启用会话回放 |
| `replaySampleRate` | number | 20 | 录制会话回放的会话百分比（1-100） |
| `defaultPrivacyLevel` | string | 'mask-user-input' | 隐私级别：'allow'（允许所有数据）、'mask'（掩盖所有数据）或'mask-user-input'（仅掩盖用户输入） |

## 访问会话回放
---

要查看会话回放：

1. 登录FlashCat控制台
2. 导航至 **RUM** > **应用程序** > **您的应用程序**
3. 点击 **会话** 选项卡
4. 选择一个会话查看其回放

您可以通过以下方式过滤会话：

- 时间范围
- 用户ID或属性
- 错误存在
- 性能问题
- 页面URL
- 用户操作
- 设备类型
- 地理位置

## 会话回放界面
---

会话回放界面包括几个关键组件：

### 回放控件

- **播放/暂停**：控制回放
- **速度控制**：调整回放速度（0.5x到4x）
- **时间轴**：导航到会话中的特定点
- **跳转按钮**：跳转到下一个操作、错误或页面更改

### 事件时间轴

时间轴显示会话中的关键事件：

- **页面视图**：页面导航和加载
- **用户操作**：点击、表单交互等
- **错误**：JavaScript错误、网络故障等
- **资源加载**：图像、脚本等的加载
- **性能事件**：长任务、布局偏移等

### 上下文面板

上下文面板提供有关会话的额外信息：

- **用户详情**：用户ID、属性等
- **设备信息**：浏览器、操作系统、屏幕尺寸
- **网络详情**：连接类型、IP地址
- **地理位置**：国家、地区、城市
- **自定义属性**：您配置的任何自定义上下文

## 隐私和安全
---

会话回放涉及捕获用户交互，因此隐私和安全至关重要：

### 隐私级别

FlashCat RUM提供三个隐私级别：

1. **允许**：记录所有内容，包括用户输入
2. **掩盖用户输入**：记录所有内容，但掩盖输入字段中的文本（默认）
3. **掩盖**：掩盖所有文本内容

```javascript
RumBrowser.init({
  // ... 其他配置选项
  defaultPrivacyLevel: 'mask-user-input' // 'allow', 'mask-user-input', 或 'mask'
});
```

### 元素级隐私

您可以使用数据属性为特定元素设置隐私级别：

```html
<!-- 允许记录此元素的内容，即使默认级别更严格 -->
<div data-privacy="allow">这将被记录</div>

<!-- 掩盖此元素的内容，即使默认级别不太严格 -->
<div data-privacy="mask">这将被掩盖</div>

<!-- 完全隐藏此元素不被记录 -->
<div data-privacy="hidden">这不会被记录</div>
```

### 敏感数据

默认情况下，FlashCat RUM不会记录以下敏感数据：

- 密码字段
- 信用卡字段
- 带有敏感名称的输入（例如，"密码"、"信用卡"、"ssn"）
- 带有`data-privacy="hidden"`属性的元素

### 合规性考虑

使用会话回放时，请考虑以下合规性最佳实践：

1. **更新隐私政策**：在您的隐私政策中披露会话回放的使用
2. **获得同意**：在适当的情况下获得用户同意
3. **数据最小化**：只记录您需要的内容
4. **数据保留**：设置适当的数据保留期限
5. **访问控制**：限制谁可以查看会话回放

## 高级用例
---

### 错误调试

当用户遇到错误时，会话回放可以提供宝贵的上下文：

1. 导航至 **RUM** > **应用程序** > **您的应用程序** > **错误**
2. 点击特定错误
3. 查看包含该错误的会话回放
4. 观察导致错误的用户操作和上下文

### 转化漏斗分析

分析转化漏斗中的放弃：

1. 导航至 **RUM** > **应用程序** > **您的应用程序** > **漏斗**
2. 创建或选择转化漏斗
3. 识别高放弃率的步骤
4. 查看在该步骤放弃的用户的会话回放
5. 寻找共同的摩擦点或混淆模式

### 用户体验研究

使用会话回放进行用户体验研究：

1. 收集代表性用户样本的会话
2. 观察他们如何与关键功能交互
3. 记录常见的行为模式和挑战
4. 使用这些洞察来指导设计改进

### A/B测试分析

使用会话回放分析A/B测试结果：

1. 为测试变体添加自定义属性
2. 过滤每个变体的会话
3. 比较用户在每个变体中的行为
4. 识别导致性能差异的具体交互

## 性能考虑
---

会话回放可能会影响应用程序性能和生成大量数据。考虑以下优化：

### 采样率

调整采样率以平衡洞察和性能：

```javascript
RumBrowser.init({
  // ... 其他配置选项
  replaySampleRate: 10 // 只录制10%的会话
});
```

### 条件录制

基于特定条件有选择地启用会话回放：

```javascript
// 只为高价值用户启用会话回放
if (userIsHighValue) {
  RumBrowser.startSessionReplayRecording();
}

// 在关键流程中启用会话回放
function startCheckoutProcess() {
  RumBrowser.startSessionReplayRecording();
  // 结账流程代码
}
```

### 资源使用

优化会话回放的资源使用：

```javascript
RumBrowser.init({
  // ... 其他配置选项
  sessionReplayEnabled: true,
  resourceSampleRate: 50, // 只采样50%的资源
  recordResourceFetchDetails: false, // 不记录资源获取详情
  recordStyleSheets: false // 不记录样式表
});
```

## 故障排查
---

如果您在使用会话回放时遇到问题：

### 没有录制会话

如果没有录制会话：

1. **检查配置**：确保`sessionReplayEnabled`设置为`true`
2. **验证采样率**：确保`replaySampleRate`不是0
3. **检查控制台错误**：查找与会话回放相关的JavaScript错误
4. **验证隐私设置**：确保您没有意外隐藏整个应用程序

### 回放质量问题

如果回放质量不佳：

1. **检查网络带宽**：确保有足够的带宽上传会话数据
2. **优化页面大小**：减少DOM大小和复杂性
3. **检查动画**：复杂动画可能不会完美回放
4. **更新SDK**：确保您使用的是最新版本的RUM SDK

### 隐私问题

如果敏感数据被记录：

1. **审查隐私设置**：确保`defaultPrivacyLevel`设置正确
2. **添加数据属性**：为包含敏感数据的元素添加`data-privacy`属性
3. **自定义掩盖**：实施自定义掩盖逻辑

## 最佳实践
---

1. **从小处开始**：从低采样率开始，根据需要增加
2. **关注关键流程**：优先录制重要的用户流程
3. **结合分析**：将会话回放与其他分析数据结合使用
4. **定期审查**：安排定期会话审查以识别模式
5. **团队协作**：让产品、设计和开发团队一起审查会话
6. **用户隐私**：始终优先考虑用户隐私和数据安全
7. **测量影响**：跟踪基于会话回放洞察的改进的影响

通过有效利用FlashCat RUM的会话回放功能，您可以获得对用户体验的深入洞察，识别并解决问题，并创建更直观、更高效的Web应用程序。
