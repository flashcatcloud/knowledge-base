
## Zoom 机器人
---
- 消息`可以发送长度为4000左右字符，超出后截断发送`；
- 如果文本中包含`<br>`，渲染时会`先删除空行，再将<br>替换为换行符`；
- 消息格式 `遵循Zoom消息格式`，当前机器人应用不支持Markdown，其他格式可以参考官网: https://developers.zoom.us/docs/team-chat-apps/customizing-messages/
- 如果不设置自定义内容，将采用系统默认模板，仅展示关键信息：

```
{"head": {
    "text": "{{fireReason .}}INC [#{{.Num}}] {{toHtml .Title}}",
    "style": {
      "bold": true,
      "italic": false,
      "color": "{{$s := serverityToColor .IncidentSeverity}}{{toHtml $s}}"
    }
  },
  "body": [
    {
      "type": "message",
      "text": "协作空间：{{if .ChannelName}}{{.ChannelName}}{{else}}无{{end}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "严重程度：{{.IncidentSeverity}}",
      "style": {
        "bold": false,
        "italic": false,
        "color": "{{$s := serverityToColor .IncidentSeverity}}{{toHtml $s}}"
      }
    },
    {
      "type": "message",
      "text": "持续时长：{{ago .StartTime}}{{if gt .AlertCnt 1}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "聚合告警：{{.AlertCnt}}条{{end}}{{if .Labels.resource}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
        "type": "message",
        "text": "告警对象：{{.Labels.resource}}{{end}}{{if .Description}}",
        "style": {
          "bold": false,
          "italic": false
        }
      },
    {
      "type": "message",
      "text": "故障描述：{{toHtml .Description}}{{end}}{{if gt (len .Responders) 0}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "分派人员：{{range .Responders}}@{{.PersonName}}{{end}}{{end}}",
      "style": {
        "bold": false,
        "italic": false
      }
    },
    {
        "type": "message",
        "text": "查看详情",
        "link": "{{.DetailUrl}}{{if .IsFlapping}}"
    },
    {
      "type": "message",
      "text": "注意：当前故障状态变化频繁，将收敛通知{{.Flapping.MuteMinutes}}分钟，建议您优化告警策略。{{end}}{{if .IsInStorm}}",
      "style": {
        "bold": true,
        "italic": false
      }
    },
    {
      "type": "message",
      "text": "注意：当前故障已聚合{{.AlertCnt}}条告警，触发告警风暴，请加急处理！{{end}}",
      "style": {
        "bold": true,
        "italic": false
      }
    }
  ]
}
```



## 短信
---
如果不设置自定义内容，将采用系统默认模板渲染通知：

```
您有故障待处理：{{toHtml .Title}}，协作空间：{{.ChannelName}}，等级：{{.IncidentSeverity}}{{if gt .AlertCnt 1}}，共聚合{{.AlertCnt}}条告警{{end}}
```



## 邮件
---
如果不设置自定义内容，将采用系统默认模板渲染通知：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>{{.Title}}</title>
<html lang="zh">

  <head data-id="__react-email-head">
	<style>
	  .bg-Critical { background-color: #C80000; }
	  .bg-Warning { background-color: #FA7D00; }
	  .bg-Info { background-color: #FABE00; }
	  .bg-Ok { background-color: rgb(132 204 22); }
	  .text-Critical { color: #C80000; }
	  .text-Warning { color: #FA7D00; }
	  .text-Info { color: #FABE00; }
	  .text-Ok { color: rgb(132 204 22); }
	  .text-title {font-weight:500;width:6rem;flex-shrink:0}
	  .text-content {color:rgb(55,65,81)}
	</style>
  </head>

  <body data-id="__react-email-body" style="background-color:rgb(255,255,255);border-radius:0.25rem;margin-top:2.5rem;margin-bottom:2.5rem;margin-left:auto;margin-right:auto;padding:1rem;min-width:400px;max-width:660px;font-family:ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji">
	<div style="width:100%;height:0.375rem;margin-bottom:2rem" class="bg-{{.IncidentSeverity}}"></div>
	<div style="display:flex;align-items:center;margin-bottom:1.5rem">
	  <div style="display:flex;align-items:flex-end;gap:1rem"><img witdh="120" data-id="react-email-img" src="https://console.flashcat.cloud/image/saas-logo.png" height="40" style="display:block;outline:none;border:none;text-decoration:none" /><span style="font-size:1.25rem;line-height:1.75rem;font-weight:600">您有故障待处理</span></div>
	</div>
	<div style="background-color:rgb(243,244,246);padding:2rem;margin-top:1rem;border-radius:0.5rem">
	  <div style="display:flex;flex-direction:column;gap:0.75rem">
		<div style="display:flex">
		  <div class="text-title">故障标题</div>
		  <div class="text-content">{{.Title}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">严重程度</div>
		  <div class="text-{{.IncidentSeverity}}">{{.IncidentSeverity}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">协作空间</div>
		  <div class="text-content">{{if .ChannelName}}{{.ChannelName}}{{else}}无{{end}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">触发时间</div>
		  <div class="text-content">{{date "2006-01-02 15:04:05" .StartTime}}</div>
		</div>
		{{if .CreatorID}}
		<div style="display:flex">
		  <div class="text-title">发起人员</div>
		  <div class="text-content">{{.Creator.PersonName}}</div>
		</div>
		{{end}}
		{{if gt (len .Responders) 0}}
		<div style="display:flex">
		  <div class="text-title">分派人员</div>
		  <div class="text-content">{{range .Responders}}@{{.PersonName}} {{end}}</div>
		</div>
		{{end}}
		<div style="display:flex">
		  <div class="text-title">处理进度</div>
		  <div class="text-content">{{.Progress}}</div>
		</div>
		<div style="display:flex">
		  <div class="text-title">故障描述</div>
		  <div style="color:rgb(55,65,81);margin-top:0.125rem">
			<div data-id="react-email-markdown">{{toHtml .Description}}</div>
		  </div>
		</div>
		{{if .Labels.resource}}
		<div style="display:flex;margin-bottom:0.5rem;">
		  <div style="color:#000;font-weight:500;width:6rem;margin-right:1rem;">告警对象</div>
		  <div style="color:rgb(55,65,81);margin-top:0.125rem">
			<div data-id="react-email-markdown">{{toHtml (joinAlertLabels . "resource" ", ")}}</div>
		  </div>
		</div>
		{{end}}
	  </div>
	  <div style="display:flex;gap:1rem;margin-top:2rem"><a href="{{.DetailUrl}}?ack=1" data-id="react-email-button" target="_blank" style="line-height:100%;text-decoration:none;display:inline-block;max-width:100%;padding:0px 0px"><span></span><span style="max-width:100%;display:inline-block;line-height:120%;mso-padding-alt:0px;mso-text-raise:0"><div style="padding-left:2rem;padding-right:2rem;padding-top:0.5rem;padding-bottom:0.5rem;background-color:rgb(108,83,177);border-radius:0.25rem;font-size:1rem;line-height:1.5rem;color:rgb(255,255,255);font-weight:600;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms">立即认领</div></span><span></span></a><a href="{{.DetailUrl}}" data-id="react-email-button" target="_blank" style="color:#61dafb;line-height:100%;text-decoration:none;display:inline-block;max-width:100%;padding:0px 0px"><span></span><span style="max-width:100%;display:inline-block;line-height:120%;mso-padding-alt:0px;mso-text-raise:0"><div style="padding-left:2rem;padding-right:2rem;padding-top:0.5rem;padding-bottom:0.5rem;background-color:rgb(255,255,255);border-width: 1px;border-style:solid;border-color:rgb(229,231,235);border-radius:0.25rem;font-size:1rem;line-height:1.5rem;color:rgb(0,0,0);font-weight:600">查看详情</div></span><span></span></a></div>
	</div>
	<div style="display:flex;justify-content:flex-end;align-items:flex-end;margin-top:2rem">
	  <div style="font-size:0.875rem;line-height:1.25rem;font-weight:500">ALL RIGHTS RESERVED © 北京快猫星云科技有限公司</div>
	</div>
  </body>

</html>
```

如下图所示：

<img src="https://download.flashcat.cloud/flashduty/changelog/20230720/email_render.png" alt="drawing" style="display: block; margin: 0 auto;" width="500"/>


